<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>传智健康day09 | 小肥龙吃大冰淇淋</title><meta name="keywords" content="javase基础,传智健康"><meta name="author" content="小肥龙吃大冰淇淋"><meta name="copyright" content="小肥龙吃大冰淇淋"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第9章 PDF报表 掌握IText实现导出预约订单信息  掌握JasperReport的模板设计器Jaspersoft Studio  掌握JasperReport导出PDF报表   在前面的课程中我们完成了将运营数据导出到Excel文件的功能。在企业开发中，除了常见的Excel形式报表，还有PDF形式的报表。那么如何导出PDF形式的报表呢？ 1.  常见的PDF报表生成方式【目标】1：了解iTe">
<meta property="og:type" content="article">
<meta property="og:title" content="传智健康day09">
<meta property="og:url" content="https://lvxueyangtiger.github.io/post/68afde2a.html">
<meta property="og:site_name" content="小肥龙吃大冰淇淋">
<meta property="og:description" content="第9章 PDF报表 掌握IText实现导出预约订单信息  掌握JasperReport的模板设计器Jaspersoft Studio  掌握JasperReport导出PDF报表   在前面的课程中我们完成了将运营数据导出到Excel文件的功能。在企业开发中，除了常见的Excel形式报表，还有PDF形式的报表。那么如何导出PDF形式的报表呢？ 1.  常见的PDF报表生成方式【目标】1：了解iTe">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212025.jpg">
<meta property="article:published_time" content="2021-12-08T07:27:00.000Z">
<meta property="article:modified_time" content="2022-11-27T09:16:44.309Z">
<meta property="article:author" content="小肥龙吃大冰淇淋">
<meta property="article:tag" content="javase基础">
<meta property="article:tag" content="传智健康">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212025.jpg"><link rel="shortcut icon" href="https://lvxueyangboke.oss-cn-beijing.aliyuncs.com/images/20210805191028.png"><link rel="canonical" href="https://lvxueyangtiger.github.io/post/68afde2a"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '传智健康day09',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-27 17:16:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/ali_icon.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mogai.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="小肥龙吃大冰淇淋" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/blog/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">303</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">108</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">73</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212025.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小肥龙吃大冰淇淋</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">传智健康day09</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-12-08T07:27:00.000Z" title="发表于 2021-12-08 15:27:00">2021-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-27T09:16:44.309Z" title="更新于 2022-11-27 17:16:44">2022-11-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AD%A6%E4%B9%A0/">java学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AD%A6%E4%B9%A0/%E4%BC%A0%E6%99%BA%E5%81%A5%E5%BA%B7/">传智健康</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="传智健康day09"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="第9章-PDF报表"><a href="#第9章-PDF报表" class="headerlink" title="第9章 PDF报表"></a>第9章 PDF报表</h1><ul>
<li><p>掌握IText实现导出预约订单信息</p>
</li>
<li><p>掌握JasperReport的模板设计器Jaspersoft Studio</p>
</li>
<li><p>掌握JasperReport导出PDF报表</p>
</li>
</ul>
<p>在前面的课程中我们完成了将运营数据导出到Excel文件的功能。在企业开发中，除了常见的Excel形式报表，还有PDF形式的报表。那么如何导出PDF形式的报表呢？</p>
<h1 id="1-常见的PDF报表生成方式"><a href="#1-常见的PDF报表生成方式" class="headerlink" title="1.  常见的PDF报表生成方式"></a>1.  常见的PDF报表生成方式</h1><h3 id="【目标】"><a href="#【目标】" class="headerlink" title="【目标】"></a>【目标】</h3><p>1：了解iText</p>
<p>2：了解JasperReport</p>
<h3 id="【路径】"><a href="#【路径】" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：iText报表的使用（需要的坐标）</p>
<p>2：JasperReports报表的使用（需要的坐标）</p>
<h3 id="【讲解】"><a href="#【讲解】" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="1-1-iText"><a href="#1-1-iText" class="headerlink" title="1.1. iText"></a>1.1. iText</h2><p>iText是著名的开放源码的站点sourceforge一个项目，是用于生成PDF文档的一个java类库。通过iText不仅可以生成PDF或rtf的文档，而且可以将XML、Html文件转化为PDF文件。 iText的安装非常方便，下载iText.jar文件后，只需要在系统的CLASSPATH中加入iText.jar的路径，在程序中就可以使用iText类库了。</p>
<p>maven坐标：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--导入Itext报表--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.lowagie<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 导入iText报表，支持中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext-asian<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-2-JasperReports"><a href="#1-2-JasperReports" class="headerlink" title="1.2. JasperReports"></a>1.2. JasperReports</h2><p>JasperReports是一个强大、灵活的报表生成工具，能够展示丰富的页面内容，并将之转换成PDF，HTML，或者XML格式。该库完全由Java写成，可以用于在各种Java应用程序，包括J2EE，Web应用程序中生成动态内容。一般情况下，JasperReports会结合Jaspersoft Studio(模板设计器)使用导出PDF报表。</p>
<p>maven坐标:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.jasperreports<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasperreports<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="【小结】"><a href="#【小结】" class="headerlink" title="【小结】"></a>【小结】</h3><ol>
<li><p>IText javaAPI 操作pdf类库  相对操作烦琐</p>
</li>
<li><p>jasperReports 是一套xml模板，可以连接数据库</p>
<ul>
<li>模板需要经过编译</li>
<li>java 调用模板填充数据 生成pdf</li>
<li>Jaspersoft Studio 是一款设计模板的可视工具</li>
</ul>
</li>
<li><p>中文显示问题</p>
<p>itext需要手动安装jar到仓库 </p>
<p>jasperReports. 设置为华文宋体, 复制字体资源</p>
</li>
</ol>
<h1 id="2-IText报表概述"><a href="#2-IText报表概述" class="headerlink" title="2. IText报表概述"></a>2. IText报表概述</h1><h3 id="【目标】-1"><a href="#【目标】-1" class="headerlink" title="【目标】"></a>【目标】</h3><p>1：iText报表入门</p>
<p>2：iText报表整合项目</p>
<h3 id="【路径】-1"><a href="#【路径】-1" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：iText报表入门案例</p>
<ul>
<li>1： 在项目 health_common 引入 Itext jar支持 </li>
<li>2：在health_common中创建测试类TestItext.java，使用Itext 生成 PDF报表</li>
<li>3：iText报表解决中文问题</li>
</ul>
<p>2：IText报表整合项目</p>
<ul>
<li>1：在页面 orderSuccess.html提供 pdf导出按钮 </li>
<li>2：添加vue提交的按钮</li>
<li>3：在OrderMobileController中添加exportSetmealInfo的方法，传递订单ID</li>
<li>4：可根据IText的API，添加表格的样式</li>
</ul>
<h3 id="【讲解】-1"><a href="#【讲解】-1" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="2-1-IText报表入门案例【重点】存小抄"><a href="#2-1-IText报表入门案例【重点】存小抄" class="headerlink" title="2.1. IText报表入门案例【重点】存小抄"></a>2.1. IText报表入门案例【重点】存小抄</h2><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164015.png" alt="img"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164016.png" alt="img"> </p>
<p>​    官网： <a target="_blank" rel="noopener" href="http://itextpdf.com/">http://itextpdf.com/</a>  最新iText7 涉及商业收费 </p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164017.png" alt="img"> </p>
<p>1： 在项目 health_parent 引入 itext.jar支持  版本管理</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>....</span><br><span class="line"><span class="comment">&lt;!--导入Itext报表--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.lowagie<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 导入iText报表，支持中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext-asian<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在项目health_common引入itext.jar支持</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 导入iText报表 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.lowagie<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 导入iText报表，支持中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext-asian<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>生成的jar包</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164018.png" alt="img"> </p>
<p>2：参考书籍：《[iText实战(第2版)].(iText.in.Action).Bruno.Lowagie.文字版.pdf》</p>
<p>生成PDF五步</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164019.png" alt="img"> </p>
<p>测试：在health_common中创建测试类TestItext.java，使用itext 生成 PDF报表 </p>
<p>示例代码:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lowagie.text.Document;</span><br><span class="line"><span class="keyword">import</span> com.lowagie.text.Paragraph;</span><br><span class="line"><span class="keyword">import</span> com.lowagie.text.pdf.PdfWriter;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: No Description</span></span><br><span class="line"><span class="comment"> * User: Eric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestItext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testItext</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 创建文件对象</span></span><br><span class="line">        Document doc = <span class="keyword">new</span> Document();</span><br><span class="line">        <span class="comment">// 设置文件存储</span></span><br><span class="line">        PdfWriter.getInstance(doc,<span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(<span class="string">&quot;d:\\iText.pdf&quot;</span>)));</span><br><span class="line">        <span class="comment">// 打开文档</span></span><br><span class="line">        doc.open();</span><br><span class="line">        doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Hello World&quot;</span>));</span><br><span class="line">        <span class="comment">// 关闭文档</span></span><br><span class="line">        doc.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里注意：中文是无法生成到pdf的。</p>
<p>3：iText报表解决中文问题</p>
<p>需要设置字体（设置可以支持中文的字库 【操作系统】 ， 【导入itext-asian的jar包】）</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 把 资料\iText\中文乱码\中的iTextAsian.jar 安装到仓库中</span></span><br><span class="line">mvn install:<span class="built_in">install-file</span> <span class="literal">-Dfile</span>=E:\iTextAsian.jar <span class="literal">-DgroupId</span>=com.alpha <span class="literal">-DartifactId</span>=itextasian <span class="literal">-Dversion</span>=<span class="number">1.0</span>.<span class="number">0</span> <span class="literal">-Dpackaging</span>=jar</span><br><span class="line"></span><br><span class="line"><span class="comment">## -Dfile=E:\iTextAsian.jar  iTextAsian 不要有中文空格</span></span><br><span class="line"><span class="comment">## idea 中的maven仓库索引更新一下</span></span><br></pre></td></tr></table></figure>



<p>坐标：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">health_common pom中</span><br><span class="line"><span class="comment">&lt;!-- 导入iText报表，支持中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext-asian<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">改成以下的</span><br><span class="line"><span class="comment">&lt;!-- 导入iText报表，支持中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alpha<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itextasian<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>参考：<img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164020.png" alt="img"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testItext</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 创建文件对象</span></span><br><span class="line">    Document doc = <span class="keyword">new</span> Document();</span><br><span class="line">    <span class="comment">// 设置文件存储</span></span><br><span class="line">    PdfWriter.getInstance(doc,<span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(<span class="string">&quot;d:\\iText.pdf&quot;</span>)));</span><br><span class="line">    <span class="comment">// 打开文档</span></span><br><span class="line">    doc.open();</span><br><span class="line">    <span class="comment">// 添加段落</span></span><br><span class="line">    BaseFont bfChinese = BaseFont.createFont(<span class="string">&quot;STSong-Light&quot;</span>, <span class="string">&quot;UniGB-UCS2-H&quot;</span>, BaseFont.NOT_EMBEDDED);</span><br><span class="line">    doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;你好，传智播客&quot;</span>, <span class="keyword">new</span> Font(bfChinese)));</span><br><span class="line">    <span class="comment">//doc.add(new Paragraph(&quot;Hello 传智播客&quot;));</span></span><br><span class="line">    <span class="comment">// 关闭文档</span></span><br><span class="line">    doc.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其中：<strong>STSong-Light</strong>和<strong>UniGB-UCS2-H</strong>对应iTextAsian.jar包的内容</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164021.png" alt="img"> </p>
<p>其中，“STSong-Light”定义了使用的中文字体，iTextAsian.jar类库中提供了几个可供使用的字体，都是以properties结尾的文件。“UniGB-UCS2-H”定义文字的编码标准和样式，GB代表编码方式为gb2312，H代表横排字，V代表竖排字，iTextAsian.jar类库中以cmap结尾的几个文件都是关于编码和样式的。</p>
<h2 id="2-2-IText报表整合项目"><a href="#2-2-IText报表整合项目" class="headerlink" title="2.2. IText报表整合项目"></a>2.2. IText报表整合项目</h2><p>【需求】：在移动端health_mobile系统中。预约成功页面，使用导出功能，导出预约的套餐信息，包括检查组-检查项。</p>
<p>1：在页面 orderSuccess.html提供 pdf导出按钮 </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;info-title&quot;</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;name&quot;</span>&gt;</span>体检预约成功<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">&quot;font-size: x-small;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;exportSetmealInfoButton&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;exportSetmealInfo()&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;导出预约订单信息&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164022.png" alt="img"></p>
<p>2：添加vue提交的按钮</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">methods:&#123;</span><br><span class="line">    <span class="function"><span class="title">exportSetmealInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.location.href = <span class="string">&quot;/order/exportSetmealInfo.do?id=&quot;</span>+id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>3：在OrderController中添加exportSetmealInfo的方法，传递订单ID</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导出预约成功信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> res</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/exportSetmealInfo&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">exportSetmealInfo</span><span class="params">(<span class="keyword">int</span> id, HttpServletResponse res)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 订单信息</span></span><br><span class="line">    Map&lt;String,Object&gt; orderInfo = orderService.findOrderDetailById(id);</span><br><span class="line">    <span class="comment">// 套餐详情</span></span><br><span class="line">    Integer setmeal_id = (Integer)orderInfo.get(<span class="string">&quot;setmeal_id&quot;</span>);</span><br><span class="line">    Setmeal setmeal = setmealService.findDetailById(setmeal_id);</span><br><span class="line">    <span class="comment">// 写到pdf里</span></span><br><span class="line">    Document doc = <span class="keyword">new</span> Document();</span><br><span class="line">    <span class="comment">// 保存到输出流</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        res.setContentType(<span class="string">&quot;application/pdf&quot;</span>);</span><br><span class="line">        res.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachement;filename=setmealInfo.pdf&quot;</span>);</span><br><span class="line">        PdfWriter.getInstance(doc, res.getOutputStream());</span><br><span class="line">        <span class="comment">// 打开文档</span></span><br><span class="line">        doc.open();</span><br><span class="line">        <span class="comment">// 写内容</span></span><br><span class="line">        <span class="comment">// 设置表格字体</span></span><br><span class="line">        BaseFont cn = BaseFont.createFont(<span class="string">&quot;STSongStd-Light&quot;</span>, <span class="string">&quot;UniGB-UCS2-H&quot;</span>,<span class="keyword">false</span>);</span><br><span class="line">        Font font = <span class="keyword">new</span> Font(cn, <span class="number">10</span>, Font.NORMAL, Color.BLUE);</span><br><span class="line"></span><br><span class="line">        doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;体检人: &quot;</span> + (String)orderInfo.get(<span class="string">&quot;member&quot;</span>),font));</span><br><span class="line">        doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;体检套餐: &quot;</span> + (String)orderInfo.get(<span class="string">&quot;setmeal&quot;</span>),font));</span><br><span class="line">        Date orderDate = (Date) orderInfo.get(<span class="string">&quot;orderDate&quot;</span>);</span><br><span class="line">        doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;体检日期: &quot;</span> + DateUtils.parseDate2String(orderDate,<span class="string">&quot;yyyy-MM-dd&quot;</span>),font));</span><br><span class="line">        doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;预约类型: &quot;</span> + (String)orderInfo.get(<span class="string">&quot;orderType&quot;</span>),font));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 套餐详情</span></span><br><span class="line">        Table table = <span class="keyword">new</span> Table(<span class="number">3</span>); <span class="comment">// 3列  表头</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//======================== 表格样式 ========================</span></span><br><span class="line">        <span class="comment">// 向document 生成pdf表格</span></span><br><span class="line">        table.setWidth(<span class="number">80</span>); <span class="comment">// 宽度</span></span><br><span class="line">        table.setBorder(<span class="number">1</span>); <span class="comment">// 边框</span></span><br><span class="line">        table.getDefaultCell().setHorizontalAlignment(Element.ALIGN_CENTER); <span class="comment">//水平对齐方式</span></span><br><span class="line">        table.getDefaultCell().setVerticalAlignment(Element.ALIGN_TOP); <span class="comment">// 垂直对齐方式</span></span><br><span class="line">        <span class="comment">/*设置表格属性*/</span></span><br><span class="line">        table.setBorderColor(<span class="keyword">new</span> Color(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)); <span class="comment">//将边框的颜色设置为蓝色</span></span><br><span class="line">        table.setPadding(<span class="number">5</span>);<span class="comment">//设置表格与字体间的间距</span></span><br><span class="line">        <span class="comment">//table.setSpacing(5);//设置表格上下的间距</span></span><br><span class="line">        table.setAlignment(Element.ALIGN_CENTER);<span class="comment">//设置字体显示居中样式</span></span><br><span class="line"></span><br><span class="line">        table.addCell(buildCell(<span class="string">&quot;项目名称&quot;</span>,font));</span><br><span class="line">        table.addCell(buildCell(<span class="string">&quot;项目内容&quot;</span>,font));</span><br><span class="line">        table.addCell(buildCell(<span class="string">&quot;项目解读&quot;</span>,font));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 检查组</span></span><br><span class="line">        List&lt;CheckGroup&gt; checkGroups = setmeal.getCheckGroups();</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> != checkGroups)&#123;</span><br><span class="line">            <span class="keyword">for</span> (CheckGroup checkGroup : checkGroups) &#123;</span><br><span class="line">                <span class="comment">// 项目名称列</span></span><br><span class="line">                table.addCell(buildCell(checkGroup.getName(),font));</span><br><span class="line">                <span class="comment">// 项目内容, 把所有的检查项拼接</span></span><br><span class="line">                List&lt;CheckItem&gt; checkItems = checkGroup.getCheckItems();</span><br><span class="line">                String checkItemStr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">null</span> != checkItems)&#123;</span><br><span class="line">                    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                    <span class="keyword">for</span> (CheckItem checkItem : checkItems) &#123;</span><br><span class="line">                        sb.append(checkItem.getName()).append(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    sb.setLength(sb.length()-<span class="number">1</span>); <span class="comment">// 去最一个空格</span></span><br><span class="line">                    <span class="comment">// 检查项的拼接完成</span></span><br><span class="line">                    checkItemStr = sb.toString();</span><br><span class="line">                &#125;</span><br><span class="line">                table.addCell(buildCell(checkItemStr,font));</span><br><span class="line">                <span class="comment">// 项目解读</span></span><br><span class="line">                table.addCell(buildCell(checkGroup.getRemark(),font));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 添加表格</span></span><br><span class="line">        doc.add(table);</span><br><span class="line">        <span class="comment">// 关闭文档</span></span><br><span class="line">        doc.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">false</span>, <span class="string">&quot;导出预约信息失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传递内容和字体样式，生成单元格</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> Cell <span class="title">buildCell</span><span class="params">(String content, Font font)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> BadElementException </span>&#123;</span><br><span class="line">    Phrase phrase = <span class="keyword">new</span> Phrase(content, font);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Cell(phrase);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>【生成pdf报表的效果】</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164023.png" alt="img"> </p>
<p>4：可根据IText的API，添加表格的样式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 向document 生成pdf表格</span></span><br><span class="line">Table table = <span class="keyword">new</span> Table(<span class="number">3</span>);<span class="comment">//创建3列的表格</span></span><br><span class="line">table.setWidth(<span class="number">80</span>); <span class="comment">// 宽度</span></span><br><span class="line">table.setBorder(<span class="number">1</span>); <span class="comment">// 边框</span></span><br><span class="line">table.getDefaultCell().setHorizontalAlignment(Element.ALIGN_CENTER); <span class="comment">//水平对齐方式</span></span><br><span class="line">table.getDefaultCell().setVerticalAlignment(Element.ALIGN_TOP); <span class="comment">// 垂直对齐方式</span></span><br><span class="line"><span class="comment">/*设置表格属性*/</span></span><br><span class="line">table.setBorderColor(<span class="keyword">new</span> Color(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)); <span class="comment">//将边框的颜色设置为蓝色</span></span><br><span class="line">table.setPadding(<span class="number">5</span>);<span class="comment">//设置表格与字体间的间距</span></span><br><span class="line"><span class="comment">//table.setSpacing(5);//设置表格上下的间距</span></span><br><span class="line">table.setAlignment(Element.ALIGN_CENTER);<span class="comment">//设置字体显示居中样式</span></span><br></pre></td></tr></table></figure>

<p>生成效果：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164024.png" alt="img"> </p>
<h3 id="【小结】-1"><a href="#【小结】-1" class="headerlink" title="【小结】"></a>【小结】</h3><p>1：iText报表入门案例</p>
<ul>
<li>1： 在项目 health_common 引入 Itext jar支持 </li>
<li>2：在health_common中创建测试类TestItext.java，使用Itext 生成 PDF报表<ul>
<li>5个步骤<ul>
<li>创建文档</li>
<li>创建pdfWriter(doc,保存的输出流)</li>
<li>打开文档</li>
<li>添加内容</li>
<li>关闭文档</li>
</ul>
</li>
</ul>
</li>
<li>3：iText报表解决中文问题 ==安装jar到仓库==(update一下maven本地仓库的索引)，再引用，idea要刷新health_common工程的依赖</li>
</ul>
<p>2：IText报表整合项目 (订单信息，套餐详情)</p>
<ul>
<li>1：在页面 orderSuccess.html提供 pdf导出按钮 </li>
<li>2：添加vue提交的按钮方法</li>
<li>3：在OrderController中添加exportSetmealInfo的方法，传递订单ID，通过订单ID查询订单信息时，要额外的查出套餐id(OrderDao.xml)</li>
<li>4：可根据IText的API，添加表格的样式(样式操作起来很烦琐，且不看好)</li>
<li>5：设置头信息，内容体类型</li>
</ul>
<h1 id="2-JasperReports概述"><a href="#2-JasperReports概述" class="headerlink" title="2. JasperReports概述"></a>2. JasperReports概述</h1><h3 id="【目标】-2"><a href="#【目标】-2" class="headerlink" title="【目标】"></a>【目标】</h3><p>1：学习JasperReport</p>
<p>2：JasperReport原理</p>
<p>3：开发流程</p>
<h3 id="【路径】-2"><a href="#【路径】-2" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：JasperReport快速体验</p>
<p>2：JasperReport原理</p>
<p>3：开发流程</p>
<h3 id="【讲解】-2"><a href="#【讲解】-2" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="3-1-JasperReports快速体验"><a href="#3-1-JasperReports快速体验" class="headerlink" title="3.1. JasperReports快速体验"></a>3.1. JasperReports快速体验</h2><p>本小节我们先通过一个快速体验来感受一下JasperReports的开发过程。</p>
<p>第一步：创建maven工程，导入JasperReports的maven坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.jasperreports<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasperreports<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二步：将提前准备好的jrxml文件(资料\pdf模板文件\demo.jrxml)复制到maven工程中(后面会详细讲解如何创建jrxml文件)</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164025.png" alt="42"></p>
<p>第三步：编写单元测试，输出PDF报表</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.sf.jasperreports.engine.*;</span><br><span class="line"><span class="keyword">import</span> net.sf.jasperreports.engine.data.JRBeanCollectionDataSource;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: No Description</span></span><br><span class="line"><span class="comment"> * User: Eric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JasperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJasperReports</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 定义模板jrxml文件路径</span></span><br><span class="line">        String jrxml = <span class="string">&quot;C:\\sz89\\jasperdemo\\src\\main\\resources\\demo.jrxml&quot;</span>;</span><br><span class="line">        <span class="comment">// 设置编译后的路径</span></span><br><span class="line">        String jasper = <span class="string">&quot;C:\\sz89\\jasperdemo\\src\\main\\resources\\demo.jasper&quot;</span>;</span><br><span class="line">        <span class="comment">// 编译模板文件</span></span><br><span class="line">        <span class="comment">// 第一个参数: jrxml, 第二个参为编译后的文件 jasper</span></span><br><span class="line">        JasperCompileManager.compileReportToFile(jrxml, jasper);</span><br><span class="line">        <span class="comment">// 构建数据</span></span><br><span class="line">        <span class="comment">//构造数据</span></span><br><span class="line">        Map paramters = <span class="keyword">new</span> HashMap();</span><br><span class="line">        paramters.put(<span class="string">&quot;reportDate&quot;</span>,<span class="string">&quot;2019-10-10&quot;</span>);</span><br><span class="line">        paramters.put(<span class="string">&quot;company&quot;</span>,<span class="string">&quot;itcast&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;Map&gt; list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        Map map1 = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map1.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;xiaoming&quot;</span>);</span><br><span class="line">        map1.put(<span class="string">&quot;address&quot;</span>,<span class="string">&quot;beijing&quot;</span>);</span><br><span class="line">        map1.put(<span class="string">&quot;email&quot;</span>,<span class="string">&quot;xiaoming@itcast.cn&quot;</span>);</span><br><span class="line">        Map map2 = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map2.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;xiaoli&quot;</span>);</span><br><span class="line">        map2.put(<span class="string">&quot;address&quot;</span>,<span class="string">&quot;nanjing&quot;</span>);</span><br><span class="line">        map2.put(<span class="string">&quot;email&quot;</span>,<span class="string">&quot;xiaoli@itcast.cn&quot;</span>);</span><br><span class="line">        list.add(map1);</span><br><span class="line">        list.add(map2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 填充数据 JRBeanCollectionDataSource自定数据</span></span><br><span class="line">        JasperPrint jasperPrint = JasperFillManager.fillReport(jasper, paramters, <span class="keyword">new</span> JRBeanCollectionDataSource(list));</span><br><span class="line">        <span class="comment">// 导出保存</span></span><br><span class="line">        String pdfPath = <span class="string">&quot;D:\\test.pdf&quot;</span>;</span><br><span class="line">        JasperExportManager.exportReportToPdfFile(jasperPrint,pdfPath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-2-JasperReports流程"><a href="#3-2-JasperReports流程" class="headerlink" title="3.2. JasperReports流程"></a>3.2. JasperReports流程</h2><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164026.png" alt="43"></p>
<ul>
<li>JRXML：报表填充模板，本质是一个xml文件</li>
<li>Jasper：由JRXML模板编译成的二进制文件，用于代码填充数据</li>
<li>Jrprint：当用数据填充完Jasper后生成的对象，用于输出报表</li>
<li>Exporter：报表输出的管理类，可以指定要输出的报表为何种格式</li>
<li>PDF/HTML/XML：报表形式</li>
</ul>
<h2 id="3-3-JasperReport开发流程【重点】"><a href="#3-3-JasperReport开发流程【重点】" class="headerlink" title="3.3. JasperReport开发流程【重点】"></a>3.3. JasperReport开发流程【重点】</h2><p>使用JasperReports导出pdf报表，开发流程如下：</p>
<ol>
<li>制作报表模板</li>
<li>模板编译</li>
<li>构造数据</li>
<li>填充数据</li>
<li>输出文件</li>
</ol>
<h3 id="【小结】-2"><a href="#【小结】-2" class="headerlink" title="【小结】"></a>【小结】</h3><p>1：JasperReport快速体验</p>
<ul>
<li>创建工程导入依赖</li>
<li>测试方法里：<ul>
<li>复制模板文件demo.jrxml resources</li>
<li>编译后的文件.jasper</li>
<li>编译</li>
<li>创建数据</li>
<li>填充数据到编译后的模板中</li>
<li>导出成pdf</li>
</ul>
</li>
</ul>
<p>2：JasperReport原理</p>
<p>3：JasperReport的开发流程</p>
<h1 id="3-模板设计器Jaspersoft-Studio"><a href="#3-模板设计器Jaspersoft-Studio" class="headerlink" title="3. 模板设计器Jaspersoft Studio"></a>3. 模板设计器Jaspersoft Studio</h1><h3 id="【目标】-3"><a href="#【目标】-3" class="headerlink" title="【目标】"></a>【目标】</h3><p>1：学习JasperReport的模板设计器Jaspersoft Studio</p>
<h3 id="【路径】-3"><a href="#【路径】-3" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：JasperReport面板介绍</p>
<p>2：创建工程和模板文件</p>
<p>3：设计模板文件</p>
<p>（1）增减Band</p>
<p>（2）将元素应用到模板中</p>
<p>（3）动态数据填充</p>
<p>4：结合JasperReport的API输出报表</p>
<p>（1）JDBC数据源方式填充数据</p>
<p>（2）JavaBean数据源方式填充数据（推荐）</p>
<h3 id="【讲解】-3"><a href="#【讲解】-3" class="headerlink" title="【讲解】"></a>【讲解】</h3><p>Jaspersoft Studio是一个图形化的报表设计工具，可以非常方便的设计出PDF报表模板文件(其实就是一个xml文件)，再结合JasperReports使用，就可以渲染出PDF文件。</p>
<p>下载地址:<a target="_blank" rel="noopener" href="https://community.jaspersoft.com/community-download">https://community.jaspersoft.com/community-download</a></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164027.png" alt="1"></p>
<p>下载完成后会得到如下安装文件：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164028.png" alt="2"></p>
<p>直接双击安装即可。</p>
<h2 id="4-1-Jaspersoft-Studio面板介绍"><a href="#4-1-Jaspersoft-Studio面板介绍" class="headerlink" title="4.1. Jaspersoft Studio面板介绍"></a>4.1. Jaspersoft Studio面板介绍</h2><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164029.png" alt="4"></p>
<h2 id="4-2-创建工程和模板文件"><a href="#4-2-创建工程和模板文件" class="headerlink" title="4.2. 创建工程和模板文件"></a>4.2. 创建工程和模板文件</h2><p>打开Jaspersoft Studio工具，首先需要创建一个工程，创建过程如下：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164030.png" alt="5"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164031.png" alt="6"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164032.png" alt="7"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164033.png" alt="8"></p>
<p>创建完工程后，可以在工程上点击右键，创建模板文件：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164034.png" alt="9"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164035.png" alt="10"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164036.png" alt="11"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164037.png" alt="12"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164038.png" alt="13"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164039.png" alt="14"></p>
<p>可以看到创建处理的模板文件后缀为jrxml，从设计区面板可以看到如下效果：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164040.png" alt="15"></p>
<p>可以看到整个文件是可视化的，分为几大区域（Title、Page Header、Column Header等），如果某些区域不需要也可以删除。</p>
<p>在面板左下角可以看到有三种视图方式：Design（设计模式）、Source（源码模式）、Preview（预览模式）:</p>
<ul>
<li>通过Design视图可以看到模板的直观结构和样式</li>
<li>通过Source视图可以看到文件xml源码</li>
<li>通过Preview视图可以预览PDF文件输出后的效果</li>
</ul>
<p>通过右侧Palette窗口可以看到常用的元素：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164041.png" alt="16"></p>
<h2 id="4-3-设计模板文件"><a href="#4-3-设计模板文件" class="headerlink" title="4.3. 设计模板文件"></a>4.3. 设计模板文件</h2><h3 id="4-3-1-增减Band"><a href="#4-3-1-增减Band" class="headerlink" title="4.3.1. 增减Band"></a>4.3.1. 增减Band</h3><p>可以根据情况删除或者增加模板文件中的区域（称为Band），例如在Page Header区域上点击右键，选择删除菜单：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164042.png" alt="17"></p>
<p>其中Detail区域可以添加多个，其他区域只能有一个。</p>
<h3 id="4-3-2-将元素应用到模板中"><a href="#4-3-2-将元素应用到模板中" class="headerlink" title="4.3.2. 将元素应用到模板中"></a>4.3.2. 将元素应用到模板中</h3><h4 id="4-3-2-1-Image元素"><a href="#4-3-2-1-Image元素" class="headerlink" title="4.3.2.1. Image元素"></a>4.3.2.1. Image元素</h4><p>从右侧Palette面板中选择Image元素（图片元素），拖动到Title区域：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164043.png" alt="18"></p>
<p>弹出如下对话框，有多种创建模式，选择URL模式，并在下面输入框中输入一个网络图片的连接地址：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164044.png" alt="19"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164045.png" alt="20"></p>
<p>可以选中图片元素，鼠标拖动调整位置，也可以通过鼠标调整图片的大小。</p>
<p>调整完成后，可以点击Preview进入预览视图，查看PDF输出效果：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164046.png" alt="21"></p>
<p>点击Source进入源码视图，查看xml文件内容：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164047.png" alt="22"></p>
<p>其实我们上面创建的demo1.jrxml模板文件，本质上就是一个xml文件，只不过我们不需要自己编写xml文件的内容，而是通过Jaspersoft Studio这个设计器软件进行可视化设计即可。</p>
<h4 id="4-3-2-2-Static-Text元素"><a href="#4-3-2-2-Static-Text元素" class="headerlink" title="4.3.2.2. Static Text元素"></a>4.3.2.2. Static Text元素</h4><p>Static Text元素就是静态文本元素，用于在PDF文件上展示静态文本信息：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164048.png" alt="23"></p>
<p>双击Title面板中的Static Text元素，可以修改文本内容：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164049.png" alt="24"></p>
<p>选中元素，也可以调整文本的字体和字号：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164050.png" alt="25"></p>
<p>点击Preview进入预览视图，查看效果：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164051.png" alt="26"></p>
<h4 id="4-3-2-3-Current-Date元素"><a href="#4-3-2-3-Current-Date元素" class="headerlink" title="4.3.2.3. Current Date元素"></a>4.3.2.3. Current Date元素</h4><p>Current Date元素用于在报表中输出当前系统日期，将改元素拖动到Title区域：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164052.png" alt="27"></p>
<p>预览输出效果：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164053.png" alt="28"></p>
<p>默认日期输出格式如上图所示，可以回到设计视图并选中元素，在Properties面板中的Text Field子标签中修改日期输出格式：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164054.png" alt="29"></p>
<p>修改日期格式：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164055.png" alt="30"></p>
<p>保存文件后重新预览：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164056.png" alt="31"></p>
<h3 id="4-3-3-动态数据填充"><a href="#4-3-3-动态数据填充" class="headerlink" title="4.3.3. 动态数据填充"></a>4.3.3. 动态数据填充</h3><p>上面我们在PDF文件中展示的都是一些静态数据，那么如果需要动态展示一些数据应该如何实现呢？我们可以使用Outline面板中的Parameters和Fields来实现。</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164057.png" alt="32"></p>
<p>Parameters通常用来展示单个数据，Fields通常用来展示需要循环的列表数据。</p>
<h4 id="4-3-3-1-Parameters"><a href="#4-3-3-1-Parameters" class="headerlink" title="4.3.3.1. Parameters"></a>4.3.3.1. Parameters</h4><p>在Parameters上点击右键，创建一个Parameter参数：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164058.png" alt="33"></p>
<p>可以在右侧的Properties面板中修改刚才创建的参数名称：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164059.png" alt="34"></p>
<p>将刚才创建的Parameter参数拖动到面板中：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164100.png" alt="35"></p>
<p>进入预览视图，查看效果：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164101.png" alt="36"></p>
<p>由于模板中我们使用了Parameter动态元素，所以在预览之前需要为其动态赋值：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164102.png" alt="37"></p>
<p>注意：由于我们是在Jaspersoft Studio软件中进行预览，所以需要通过上面的输入框动态为Parameter赋值，在后期项目使用时，需要我们在Java程序中动态为Parameter赋值进行数据填充。</p>
<h4 id="4-3-3-2-Fields"><a href="#4-3-3-2-Fields" class="headerlink" title="4.3.3.2. Fields"></a>4.3.3.2. Fields</h4><p>使用Fields方式进行数据填充，既可以使用jdbc数据源方式也可以使用JavaBean数据源方式。</p>
<ul>
<li>jdbc数据源数据填充</li>
</ul>
<p>第一步：在Repository Explorer面板中，在Data Adapters点击右键，创建一个数据适配器</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164103.png" alt="38"></p>
<p>第二步：选择Database JDBC Connection</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164104.png" alt="39"></p>
<p>第三步：选择mysql数据库，并完善jdbc连接信息</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164105.png" alt="40"></p>
<p>为了能够在Jaspersoft Studio中预览到数据库中的数据，需要加入MySQL的驱动包</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164106.png" alt="41"></p>
<p>第四步：回到Design模式下，在Outline视图中，右键点击工程名，选择Database and Query菜单</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164107.png" alt="44"></p>
<p>第五步：在弹出的对话框中选择刚刚创建的JDBC数据库连接选项</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164108.png" alt="45"></p>
<p>第六步：在弹出对话框中Language选择sql，在右侧区域输入SQL语句并点击Read Fields按钮</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164109.png" alt="46"></p>
<p>可以看到通过点击上面的Read Fields按钮，已经读取到了t_setmeal表中的所有字段信息并展示在了下面，这些字段可以根据需要进行删除或者调整位置</p>
<p>第七步：在Outline视图中的Fields下可以看到t_setmeal表中相关字段信息，拖动某个字段到设计区的Detail区域并调整位置</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164110.png" alt="47"></p>
<p>可以看到，在拖动Fields到设计区时，同时会产生两个元素，一个是静态文本，一个是动态元素。静态文本相当于表格的表头，可以根据需要修改文本内容。最终设计完的效果如下：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164111.png" alt="48"></p>
<p>第八步：使用Preview预览视图进行预览</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164112.png" alt="49"></p>
<p>通过上图可以看到，虽然列表数据展示出来了，但是展示的还存在问题。在每条数据遍历时表头也跟着遍历了一遍。这是怎么回事呢？这是由于我们设计的表头和动态Fields都在Detail区域。为了能够解决上面的问题，需要将表头放在Column Header区域，将动态Fields放在Detail区域。具体操作如下：</p>
<p>1、在Outline视图的Column Header点击右键创建出一个区域</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164113.png" alt="50"></p>
<p>2、将Detail下的静态文本拖动到Column Header下</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164114.png" alt="51"></p>
<p>拖动完成后如下：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164115.png" alt="52"></p>
<p>3、调整静态文本在Column Header区域的位置，最终效果如下</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164116.png" alt="53"></p>
<p>4、预览查看效果</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164117.png" alt="54"></p>
<ul>
<li>JavaBean数据源数据填充</li>
</ul>
<p>第一步：复制上面的demo1.jrxml文件，名称改为demo2.jrxml</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164118.png" alt="55"></p>
<p>修改Report Name：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164119.png" alt="57"></p>
<p>第二步：打开demo2.jrxml文件，将detail区域中的动态Fields元素删除</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164120.png" alt="56"></p>
<p>第三步：将Outline面板中Fields下的字段全部删除</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164121.png" alt="58"></p>
<p>第四步：清除JDBC数据源和相关SQL语句</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164122.png" alt="61"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164123.png" alt="62"></p>
<p>第五步：在Fields处点击右键创建新的Field</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164124.png" alt="59"></p>
<p>创建完成后在Properties属性面板中修改Field的名称</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164125.png" alt="60"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164126.png" alt="63"></p>
<p>第六步：将创建的Fields拖动到Detail区域并调整好位置</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164127.png" alt="64"></p>
<p>注意：使用此种JavaBean数据源数据填充方式，无法正常进行预览，因为这些动态Fields需要在Java程序中动态进行数据填充。</p>
<h4 id="4-3-3-3-边框"><a href="#4-3-3-3-边框" class="headerlink" title="4.3.3.3. 边框"></a>4.3.3.3. 边框</h4><p>选中表格框，在Borders下添加边框</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164128.png" alt="002"></p>
<h2 id="4-4-结合JasperReports输出报表"><a href="#4-4-结合JasperReports输出报表" class="headerlink" title="4.4. 结合JasperReports输出报表"></a>4.4. 结合JasperReports输出报表</h2><p>前面我们已经使用Jaspersoft Studio设计了两个模板文件：demo1.jrxml和demo2.jrxml。其中demo1.jrxml的动态列表数据是基于JDBC数据源方式进行数据填充，demo2.jrxml的动态列表数据是基于JavaBean数据源方式进行数据填充。本小节我们就结合JasperReports的Java API来完成pdf报表输出。</p>
<h3 id="4-4-1-JDBC数据源方式填充数据"><a href="#4-4-1-JDBC数据源方式填充数据" class="headerlink" title="4.4.1. JDBC数据源方式填充数据"></a>4.4.1. JDBC数据源方式填充数据</h3><p>第一步：创建maven工程，导入相关maven坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.jasperreports<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasperreports<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二步：将设计好的demo1.jrxml文件复制到当前工程的resources目录下</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164129.png" alt="65"></p>
<p>第三步：编写单元测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJDBCDataSource</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    <span class="comment">// 定义模板jrxml文件路径</span></span><br><span class="line">    String jrxml = <span class="string">&quot;C:\\sz89\\jasperdemo\\src\\main\\resources\\demo1.jrxml&quot;</span>;</span><br><span class="line">    <span class="comment">// 设置编译后的路径</span></span><br><span class="line">    String jasper = <span class="string">&quot;C:\\sz89\\jasperdemo\\src\\main\\resources\\demo1.jasper&quot;</span>;</span><br><span class="line">    <span class="comment">// 编译模板文件</span></span><br><span class="line">    <span class="comment">// 第一个参数: jrxml, 第二个参为编译后的文件 jasper</span></span><br><span class="line">    JasperCompileManager.compileReportToFile(jrxml, jasper);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// jdbc connection</span></span><br><span class="line"></span><br><span class="line">    Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">    Connection connection = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql:///health89&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Map paramters = <span class="keyword">new</span> HashMap();</span><br><span class="line">    paramters.put(<span class="string">&quot;company&quot;</span>,<span class="string">&quot;itcast&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 填充数据 JRBeanCollectionDataSource自定数据</span></span><br><span class="line">    JasperPrint jasperPrint = JasperFillManager.fillReport(jasper, paramters, connection);</span><br><span class="line">    <span class="comment">// 导出保存</span></span><br><span class="line">    String pdfPath = <span class="string">&quot;D:\\testJDBC.pdf&quot;</span>;</span><br><span class="line">    JasperExportManager.exportReportToPdfFile(jasperPrint,pdfPath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过上面的操作步骤可以输出pdf文件，但是中文的地方无法正常显示。这是因为JasperReports默认情况下对中文支持并不友好，需要我们自己进行修复。具体操作步骤如下：</p>
<p>1、在Jaspersoft Studio中打开demo1.jrxml文件，选中中文相关元素，统一将字体设置为“华文宋体”并将修改后的demo1.jrxml重新复制到maven工程中</p>
<h3 id="解决中文显示"><a href="#解决中文显示" class="headerlink" title="解决中文显示"></a>解决中文显示</h3><p>2、将本章资源/解决中文无法显示问题目录下的文件复制到maven工程的resources目录中</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164130.png" alt="66"></p>
<p>按照上面步骤操作后重新执行单元测试导出PDF文件：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164131.png" alt="67"></p>
<h3 id="4-4-2-JavaBean数据源方式填充数据【重点】"><a href="#4-4-2-JavaBean数据源方式填充数据【重点】" class="headerlink" title="4.4.2. JavaBean数据源方式填充数据【重点】"></a>4.4.2. JavaBean数据源方式填充数据【重点】</h3><p>第一步：为了能够避免中文无法显示问题，首先需要将demo2.jrxml文件相关元素字体改为“华文宋体”并将demo2.jrxml文件复制到maven工程的resources目录下</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164132.png" alt="68"></p>
<p>第二步：编写单元测试方法输出PDF文件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJavaBean</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 定义模板jrxml文件路径</span></span><br><span class="line">    String jrxml = <span class="string">&quot;C:\\sz89\\jasperdemo\\src\\main\\resources\\demo2.jrxml&quot;</span>;</span><br><span class="line">    <span class="comment">// 设置编译后的路径</span></span><br><span class="line">    String jasper = <span class="string">&quot;C:\\sz89\\jasperdemo\\src\\main\\resources\\demo2.jasper&quot;</span>;</span><br><span class="line">    <span class="comment">// 编译模板文件</span></span><br><span class="line">    <span class="comment">// 第一个参数: jrxml, 第二个参为编译后的文件 jasper</span></span><br><span class="line">    JasperCompileManager.compileReportToFile(jrxml, jasper);</span><br><span class="line">    <span class="comment">// 构建数据</span></span><br><span class="line">    <span class="comment">//构造数据</span></span><br><span class="line">    Map paramters = <span class="keyword">new</span> HashMap();</span><br><span class="line">    paramters.put(<span class="string">&quot;company&quot;</span>,<span class="string">&quot;传智播客&quot;</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;Map&gt; list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">    Map map1 = <span class="keyword">new</span> HashMap();</span><br><span class="line">    map1.put(<span class="string">&quot;tName&quot;</span>,<span class="string">&quot;入职体检套餐&quot;</span>);</span><br><span class="line">    map1.put(<span class="string">&quot;tCode&quot;</span>,<span class="string">&quot;RZTJ&quot;</span>);</span><br><span class="line">    map1.put(<span class="string">&quot;tAge&quot;</span>,<span class="string">&quot;18-60&quot;</span>);</span><br><span class="line">    map1.put(<span class="string">&quot;tPrice&quot;</span>,<span class="number">500d</span>);</span><br><span class="line"></span><br><span class="line">    Map map2 = <span class="keyword">new</span> HashMap();</span><br><span class="line">    map2.put(<span class="string">&quot;tName&quot;</span>,<span class="string">&quot;阳光爸妈老年健康体检&quot;</span>);</span><br><span class="line">    map2.put(<span class="string">&quot;tCode&quot;</span>,<span class="string">&quot;YGBM&quot;</span>);</span><br><span class="line">    map2.put(<span class="string">&quot;tAge&quot;</span>,<span class="string">&quot;55-60&quot;</span>);</span><br><span class="line">    map2.put(<span class="string">&quot;tPrice&quot;</span>,<span class="number">500d</span>);</span><br><span class="line">    list.add(map1);</span><br><span class="line">    list.add(map2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 填充数据 JRBeanCollectionDataSource自定数据</span></span><br><span class="line">    JasperPrint jasperPrint = JasperFillManager.fillReport(jasper, paramters, <span class="keyword">new</span> JRBeanCollectionDataSource(list));</span><br><span class="line">    <span class="comment">// 导出保存</span></span><br><span class="line">    String pdfPath = <span class="string">&quot;D:\\testJavaBean.pdf&quot;</span>;</span><br><span class="line">    JasperExportManager.exportReportToPdfFile(jasperPrint,pdfPath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看输出效果：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164133.png" alt="69"></p>
<h3 id="【小结】-3"><a href="#【小结】-3" class="headerlink" title="【小结】"></a>【小结】</h3><p>1：JasperReport面板介绍</p>
<p>2：创建工程和模板文件</p>
<p>3：设计模板文件</p>
<p>（1）增减Band</p>
<p>（2）将元素应用到模板中 拖拽组件 设置属性</p>
<p>（3）动态数据填充</p>
<ul>
<li>数据库连接Connection  (create database adapter   mysql -&gt; 指定驱动jar)  Detail</li>
<li>自定义JavaBean的方式 one record empty row   Detail</li>
</ul>
<p>4：结合JasperReport的API输出报表</p>
<p>（1）JDBC数据源方式填充数据 connection</p>
<p>（2）JavaBean数据源方式填充数据（推荐）</p>
<p>【注】【注】【注】：设计的模板中，所有的中文字符全部使用【华文宋体】</p>
<p>复制资料中的 \解决中文无法显示问题\ 目录下的文件到resources目录下</p>
<h1 id="4-在项目中输出运营数据PDF报表【重点】"><a href="#4-在项目中输出运营数据PDF报表【重点】" class="headerlink" title="4.在项目中输出运营数据PDF报表【重点】"></a>4.在项目中输出运营数据PDF报表【重点】</h1><h3 id="【目标】-4"><a href="#【目标】-4" class="headerlink" title="【目标】"></a>【目标】</h3><p>1：项目应用，项目中输出运营数据统计的PDF报表</p>
<h3 id="【路径】-4"><a href="#【路径】-4" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：设计PDF模板文件</p>
<p>2：搭建环境</p>
<p>3：修改页面</p>
<p>4：代码实现</p>
<h3 id="【讲解】-4"><a href="#【讲解】-4" class="headerlink" title="【讲解】"></a>【讲解】</h3><p>本小节我们将在项目中实现运营数据的PDF报表导出功能。</p>
<h2 id="5-1-设计PDF模板文件【次重点】"><a href="#5-1-设计PDF模板文件【次重点】" class="headerlink" title="5.1. 设计PDF模板文件【次重点】"></a>5.1. 设计PDF模板文件【次重点】</h2><p>使用Jaspersoft Studio设计运营数据PDF报表模板文件health_business3.jrxml，设计后的效果如下：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164134.png" alt="70"></p>
<p>在资源中已经提供好了此文件，直接使用即可，但是让大家更好的掌握Jaspersoft Studio，我们重新画。</p>
<p>注意1：需要使用Title、Column Header、Detail，剩下的不需要</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164135.png" alt="003"></p>
<p>其中：</p>
<p>注意事项一：</p>
<p>1：Title</p>
<p>用于存放图片，并显示图片</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164136.png" alt="004"></p>
<p>2：Column Header</p>
<p>用于存放静态文本（static Text）和变量（parameters），表示显示文本数据，并使用参数的形式传递</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164137.png" alt="008"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164138.png" alt="005"></p>
<p>3：Detail</p>
<p>用于存放Fields，表示循环遍历热门套餐。</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164139.png" alt="007"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164140.png" alt="006"></p>
<p>注意事项二：</p>
<p>类型要一致</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>：Paramters：</span><br><span class="line"></span><br><span class="line">reportDate --&gt; java.lang.String</span><br><span class="line">todayNewMember -- &gt; java.lang.Integer</span><br><span class="line">totalMember -- &gt; java.lang.Integer</span><br><span class="line">thisWeekNewMember -- &gt; java.lang.Integer</span><br><span class="line">thisMonthNewMember -- &gt; java.lang.Integer</span><br><span class="line">todayOrderNumber -- &gt; java.lang.Integer</span><br><span class="line">todayVisitsNumber -- &gt; java.lang.Integer</span><br><span class="line">thisWeekOrderNumber -- &gt; java.lang.Integer</span><br><span class="line">thisWeekVisitsNumber -- &gt; java.lang.Integer</span><br><span class="line">thisMonthOrderNumber -- &gt; java.lang.Integer</span><br><span class="line">thisMonthVisitsNumber -- &gt; java.lang.Integer</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>：Fields：</span><br><span class="line"></span><br><span class="line">name --&gt; java.lang.String</span><br><span class="line">setmeal_count --&gt; java.lang.Long</span><br><span class="line">proportion --&gt; java.math.BigDecimal</span><br></pre></td></tr></table></figure>

<p>字体一定要是 华文宋体</p>
<h2 id="5-2-搭建环境"><a href="#5-2-搭建环境" class="headerlink" title="5.2. 搭建环境"></a>5.2. 搭建环境</h2><p>第一步：在health_parent工程的pom.xml中导入JasperReports的maven坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">jasperreports</span>&gt;</span>6.8.0<span class="tag">&lt;/<span class="name">jasperreports</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.jasperreports<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasperreports<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jasperreports&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在health_common工程的pom.xml中导入JasperReports的maven坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.jasperreports<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasperreports<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二步：将资源中提供的模板文件health_business3.jrxml复制到health_web工程的template目录下</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164141.png" alt="71"></p>
<p>第三步：将解决中问题的相关资源文件复制到项目中</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164142.png" alt="72"></p>
<h2 id="5-3-修改页面"><a href="#5-3-修改页面" class="headerlink" title="5.3. 修改页面"></a>5.3. 修改页面</h2><p>修改health_web工程的report_business.html页面，添加导出PDF的按钮并绑定事件</p>
<p> <img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164143.png" alt="image-20200703171710380"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209164144.png" alt="image-20200703171620301"></p>
<h2 id="5-4-Java代码实现"><a href="#5-4-Java代码实现" class="headerlink" title="5.4. Java代码实现"></a>5.4. Java代码实现</h2><p>在health_web工程的ReportController中提供exportBusinessReport4PDF方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导出运营统计数据报表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/exportBusinessReportPdf&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">exportBusinessReportPdf</span><span class="params">(HttpServletRequest req, HttpServletResponse res)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 获取模板的路径, getRealPath(&quot;/&quot;) 相当于到webapp目录下</span></span><br><span class="line">    String basePath = req.getSession().getServletContext().getRealPath(<span class="string">&quot;/template&quot;</span>);</span><br><span class="line">    <span class="comment">// jrxml路径</span></span><br><span class="line">    String jrxml = basePath + File.separator + <span class="string">&quot;report_business.jrxml&quot;</span>;</span><br><span class="line">    <span class="comment">// jasper路径</span></span><br><span class="line">    String jasper = basePath + File.separator + <span class="string">&quot;report_business.jasper&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 编译模板</span></span><br><span class="line">        JasperCompileManager.compileReportToFile(jrxml, jasper);</span><br><span class="line">        Map&lt;String, Object&gt; businessReport = reportService.getBusinessReport();</span><br><span class="line">        <span class="comment">// 热门套餐(list -&gt; Detail1)</span></span><br><span class="line">        List&lt;Map&lt;String,Object&gt;&gt; hotSetmeals = (List&lt;Map&lt;String,Object&gt;&gt;)businessReport.get(<span class="string">&quot;hotSetmeal&quot;</span>);</span><br><span class="line">        <span class="comment">// 填充数据 JRBeanCollectionDataSource自定义数据</span></span><br><span class="line">        JasperPrint jasperPrint = JasperFillManager.fillReport(jasper, businessReport, <span class="keyword">new</span> JRBeanCollectionDataSource(hotSetmeals));</span><br><span class="line">        res.setContentType(<span class="string">&quot;application/pdf&quot;</span>);</span><br><span class="line">        res.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachement;filename=businessReport.pdf&quot;</span>);</span><br><span class="line">        JasperExportManager.exportReportToPdfStream(jasperPrint, res.getOutputStream());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">false</span>,<span class="string">&quot;导出运营数据统计pdf失败&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【小结】-4"><a href="#【小结】-4" class="headerlink" title="【小结】"></a>【小结】</h3><p>1：设计PDF模板文件</p>
<p>   注意：</p>
<ol>
<li><p>如果是个单个变量（不需要循环）不要放到Detail，配以静态文本</p>
</li>
<li><p>如果是一个集合的数据需要用到遍历，放到Detail 循环</p>
</li>
<li><p>中文显示问题</p>
<ul>
<li>模板中，所有的中文一定要设置它的字体为 ==“华文宋体”==</li>
<li>在项目Resources目录，添加宋体的支持</li>
<li>注意看target目录，有没加入中文显示支持</li>
</ul>
</li>
<li><p>参数对应的数据类型</p>
<p>会员数量，预约数量 类型都为integer</p>
<p>热门套餐 name Stirng, setmeal_count long, propertion: BigDecimal</p>
</li>
</ol>
<p>2：搭建环境</p>
<p>引入依赖</p>
<p>3：修改页面</p>
<p>添加导出按钮，添加导出按钮的事件方法</p>
<p>4：代码实现</p>
<p>获取模板，编译模板，填充数据，导出 设置头信息，内容体</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">小肥龙吃大冰淇淋</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://lvxueyangtiger.github.io/post/68afde2a.html">https://lvxueyangtiger.github.io/post/68afde2a.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lvxueyangtiger.github.io" target="_blank">小肥龙吃大冰淇淋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/javase%E5%9F%BA%E7%A1%80/">javase基础</a><a class="post-meta__tags" href="/tags/%E4%BC%A0%E6%99%BA%E5%81%A5%E5%BA%B7/">传智健康</a></div><div class="post_share"><div class="social-share" data-image="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212025.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/66745618.html"><img class="prev-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082137.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">传智健康day01</div></div></a></div><div class="next-post pull-right"><a href="/post/1fa8eebc.html"><img class="next-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212044.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">传智健康day08</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/ff7d07a2.html" title="传智健康day02"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082319.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day02</div></div></a></div><div><a href="/post/86857cf.html" title="传智健康day10"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082055.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day10</div></div></a></div><div><a href="/post/887a3734.html" title="传智健康day03"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082121.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day03</div></div></a></div><div><a href="/post/161ea297.html" title="传智健康day04"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212120.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day04</div></div></a></div><div><a href="/post/66745618.html" title="传智健康day01"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082137.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day01</div></div></a></div><div><a href="/post/1fa8eebc.html" title="传智健康day08"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212044.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day08</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC9%E7%AB%A0-PDF%E6%8A%A5%E8%A1%A8"><span class="toc-number">1.</span> <span class="toc-text">第9章 PDF报表</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%B8%B8%E8%A7%81%E7%9A%84PDF%E6%8A%A5%E8%A1%A8%E7%94%9F%E6%88%90%E6%96%B9%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">1.  常见的PDF报表生成方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91"><span class="toc-number">2.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91"><span class="toc-number">2.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91"><span class="toc-number">2.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-iText"><span class="toc-number">2.1.</span> <span class="toc-text">1.1. iText</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-JasperReports"><span class="toc-number">2.2.</span> <span class="toc-text">1.2. JasperReports</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91"><span class="toc-number">2.2.1.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-IText%E6%8A%A5%E8%A1%A8%E6%A6%82%E8%BF%B0"><span class="toc-number">3.</span> <span class="toc-text">2. IText报表概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-1"><span class="toc-number">3.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-1"><span class="toc-number">3.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-1"><span class="toc-number">3.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-IText%E6%8A%A5%E8%A1%A8%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91%E5%AD%98%E5%B0%8F%E6%8A%84"><span class="toc-number">3.1.</span> <span class="toc-text">2.1. IText报表入门案例【重点】存小抄</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-IText%E6%8A%A5%E8%A1%A8%E6%95%B4%E5%90%88%E9%A1%B9%E7%9B%AE"><span class="toc-number">3.2.</span> <span class="toc-text">2.2. IText报表整合项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-1"><span class="toc-number">3.2.1.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-JasperReports%E6%A6%82%E8%BF%B0"><span class="toc-number">4.</span> <span class="toc-text">2. JasperReports概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-2"><span class="toc-number">4.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-2"><span class="toc-number">4.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-2"><span class="toc-number">4.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-JasperReports%E5%BF%AB%E9%80%9F%E4%BD%93%E9%AA%8C"><span class="toc-number">4.1.</span> <span class="toc-text">3.1. JasperReports快速体验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-JasperReports%E6%B5%81%E7%A8%8B"><span class="toc-number">4.2.</span> <span class="toc-text">3.2. JasperReports流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-JasperReport%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91"><span class="toc-number">4.3.</span> <span class="toc-text">3.3. JasperReport开发流程【重点】</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-2"><span class="toc-number">4.3.1.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E6%A8%A1%E6%9D%BF%E8%AE%BE%E8%AE%A1%E5%99%A8Jaspersoft-Studio"><span class="toc-number">5.</span> <span class="toc-text">3. 模板设计器Jaspersoft Studio</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-3"><span class="toc-number">5.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-3"><span class="toc-number">5.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-3"><span class="toc-number">5.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-Jaspersoft-Studio%E9%9D%A2%E6%9D%BF%E4%BB%8B%E7%BB%8D"><span class="toc-number">5.1.</span> <span class="toc-text">4.1. Jaspersoft Studio面板介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E5%88%9B%E5%BB%BA%E5%B7%A5%E7%A8%8B%E5%92%8C%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6"><span class="toc-number">5.2.</span> <span class="toc-text">4.2. 创建工程和模板文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6"><span class="toc-number">5.3.</span> <span class="toc-text">4.3. 设计模板文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1-%E5%A2%9E%E5%87%8FBand"><span class="toc-number">5.3.1.</span> <span class="toc-text">4.3.1. 增减Band</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-2-%E5%B0%86%E5%85%83%E7%B4%A0%E5%BA%94%E7%94%A8%E5%88%B0%E6%A8%A1%E6%9D%BF%E4%B8%AD"><span class="toc-number">5.3.2.</span> <span class="toc-text">4.3.2. 将元素应用到模板中</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-1-Image%E5%85%83%E7%B4%A0"><span class="toc-number">5.3.2.1.</span> <span class="toc-text">4.3.2.1. Image元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-2-Static-Text%E5%85%83%E7%B4%A0"><span class="toc-number">5.3.2.2.</span> <span class="toc-text">4.3.2.2. Static Text元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-3-Current-Date%E5%85%83%E7%B4%A0"><span class="toc-number">5.3.2.3.</span> <span class="toc-text">4.3.2.3. Current Date元素</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-3-%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E5%A1%AB%E5%85%85"><span class="toc-number">5.3.3.</span> <span class="toc-text">4.3.3. 动态数据填充</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-1-Parameters"><span class="toc-number">5.3.3.1.</span> <span class="toc-text">4.3.3.1. Parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-2-Fields"><span class="toc-number">5.3.3.2.</span> <span class="toc-text">4.3.3.2. Fields</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-3-%E8%BE%B9%E6%A1%86"><span class="toc-number">5.3.3.3.</span> <span class="toc-text">4.3.3.3. 边框</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E7%BB%93%E5%90%88JasperReports%E8%BE%93%E5%87%BA%E6%8A%A5%E8%A1%A8"><span class="toc-number">5.4.</span> <span class="toc-text">4.4. 结合JasperReports输出报表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-1-JDBC%E6%95%B0%E6%8D%AE%E6%BA%90%E6%96%B9%E5%BC%8F%E5%A1%AB%E5%85%85%E6%95%B0%E6%8D%AE"><span class="toc-number">5.4.1.</span> <span class="toc-text">4.4.1. JDBC数据源方式填充数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E4%B8%AD%E6%96%87%E6%98%BE%E7%A4%BA"><span class="toc-number">5.4.2.</span> <span class="toc-text">解决中文显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-2-JavaBean%E6%95%B0%E6%8D%AE%E6%BA%90%E6%96%B9%E5%BC%8F%E5%A1%AB%E5%85%85%E6%95%B0%E6%8D%AE%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91"><span class="toc-number">5.4.3.</span> <span class="toc-text">4.4.2. JavaBean数据源方式填充数据【重点】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-3"><span class="toc-number">5.4.4.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E8%BE%93%E5%87%BA%E8%BF%90%E8%90%A5%E6%95%B0%E6%8D%AEPDF%E6%8A%A5%E8%A1%A8%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91"><span class="toc-number">6.</span> <span class="toc-text">4.在项目中输出运营数据PDF报表【重点】</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-4"><span class="toc-number">6.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-4"><span class="toc-number">6.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-4"><span class="toc-number">6.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E8%AE%BE%E8%AE%A1PDF%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%E3%80%90%E6%AC%A1%E9%87%8D%E7%82%B9%E3%80%91"><span class="toc-number">6.1.</span> <span class="toc-text">5.1. 设计PDF模板文件【次重点】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83"><span class="toc-number">6.2.</span> <span class="toc-text">5.2. 搭建环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E4%BF%AE%E6%94%B9%E9%A1%B5%E9%9D%A2"><span class="toc-number">6.3.</span> <span class="toc-text">5.3. 修改页面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-Java%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">6.4.</span> <span class="toc-text">5.4. Java代码实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-4"><span class="toc-number">6.4.1.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 小肥龙吃大冰淇淋</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="framework-info"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/202301132049386.png"/><span> </span><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">晋ICP备2022012091号-1</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'pinglun-9gh2lmcnd8587831',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'pinglun-9gh2lmcnd8587831',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script><script src="//code.tidio.co/smwivpnwumemac2wohardi3d3gpud1ag.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>