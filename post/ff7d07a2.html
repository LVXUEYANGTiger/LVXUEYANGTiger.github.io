<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>传智健康day02 | 小肥龙吃大冰淇淋</title><meta name="keywords" content="javase基础,传智健康"><meta name="author" content="小肥龙吃大冰淇淋"><meta name="copyright" content="小肥龙吃大冰淇淋"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第2章 预约管理-检查项、检查组管理学习目标：  掌握新增检查项实现过程  掌握检查项分页查询实现过程  掌握删除检查项实现过程  掌握编辑检查项实现过程  掌握新增检查组实现过程  掌握检查组分页查询实现过程  掌握删除检查组实现过程  掌握编辑检查组实现过程   1. 新增检查项​    本章节完成的功能开发是预约管理功能，包括检查项管理（身高，体重）、检查组管理（外科）、体检套餐管理（公司健">
<meta property="og:type" content="article">
<meta property="og:title" content="传智健康day02">
<meta property="og:url" content="https://lvxueyangtiger.github.io/post/ff7d07a2.html">
<meta property="og:site_name" content="小肥龙吃大冰淇淋">
<meta property="og:description" content="第2章 预约管理-检查项、检查组管理学习目标：  掌握新增检查项实现过程  掌握检查项分页查询实现过程  掌握删除检查项实现过程  掌握编辑检查项实现过程  掌握新增检查组实现过程  掌握检查组分页查询实现过程  掌握删除检查组实现过程  掌握编辑检查组实现过程   1. 新增检查项​    本章节完成的功能开发是预约管理功能，包括检查项管理（身高，体重）、检查组管理（外科）、体检套餐管理（公司健">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082319.jpg">
<meta property="article:published_time" content="2021-12-08T07:27:00.000Z">
<meta property="article:modified_time" content="2022-11-27T09:16:44.122Z">
<meta property="article:author" content="小肥龙吃大冰淇淋">
<meta property="article:tag" content="javase基础">
<meta property="article:tag" content="传智健康">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082319.jpg"><link rel="shortcut icon" href="https://lvxueyangboke.oss-cn-beijing.aliyuncs.com/images/20210805191028.png"><link rel="canonical" href="https://lvxueyangtiger.github.io/post/ff7d07a2"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '传智健康day02',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-27 17:16:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/ali_icon.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mogai.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="小肥龙吃大冰淇淋" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/blog/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">303</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">108</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">73</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082319.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小肥龙吃大冰淇淋</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">传智健康day02</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-12-08T07:27:00.000Z" title="发表于 2021-12-08 15:27:00">2021-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-27T09:16:44.122Z" title="更新于 2022-11-27 17:16:44">2022-11-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AD%A6%E4%B9%A0/">java学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java%E5%AD%A6%E4%B9%A0/%E4%BC%A0%E6%99%BA%E5%81%A5%E5%BA%B7/">传智健康</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>49分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="传智健康day02"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="第2章-预约管理-检查项、检查组管理"><a href="#第2章-预约管理-检查项、检查组管理" class="headerlink" title="第2章 预约管理-检查项、检查组管理"></a>第2章 预约管理-检查项、检查组管理</h1><p>学习目标：</p>
<ul>
<li><p>掌握新增检查项实现过程</p>
</li>
<li><p>掌握检查项分页查询实现过程</p>
</li>
<li><p>掌握删除检查项实现过程</p>
</li>
<li><p>掌握编辑检查项实现过程</p>
</li>
<li><p>掌握新增检查组实现过程</p>
</li>
<li><p>掌握检查组分页查询实现过程</p>
</li>
<li><p>掌握删除检查组实现过程</p>
</li>
<li><p>掌握编辑检查组实现过程</p>
</li>
</ul>
<h1 id="1-新增检查项"><a href="#1-新增检查项" class="headerlink" title="1. 新增检查项"></a>1. 新增检查项</h1><p>​    本章节完成的功能开发是预约管理功能，包括检查项管理（身高，体重）、检查组管理（外科）、体检套餐管理（公司健康体检）、预约设置等（参见产品原型）。预约管理属于系统的基础功能，主要就是管理一些体检的基础数据。</p>
<h3 id="【目标】"><a href="#【目标】" class="headerlink" title="【目标】"></a>【目标】</h3><p>新增检查项</p>
<h3 id="【路径】"><a href="#【路径】" class="headerlink" title="【路径】"></a>【路径】</h3><ol>
<li>checkitem.html, 新建按钮绑定事件，弹出新增窗口，填写内容，点击确定绑定事件 提交(前要校验一下，成功后才能提交(axios)) formData，对返回的结果提示信息，如果成功，则要关闭新增窗口，且刷新列表数据</li>
<li>CheckItemController, 用checkitem来接收formData, 调用服务添加add，返回result给页面</li>
<li>CheckItemService与实现 add 方法, 调用dao</li>
<li>CheckItemDao与映射文件 添加add方法，insert into t_checkitem () values(…)</li>
</ol>
<h3 id="【讲解】"><a href="#【讲解】" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="1-1-前台代码"><a href="#1-1-前台代码" class="headerlink" title="1.1. 前台代码"></a>1.1. <strong>前台代码</strong></h2><p>检查项管理页面对应的是checkitem.html页面，根据产品设计的原型已经完成了页面基本结构的编写，现在需要完善页面动态效果。</p>
<h3 id="1-1-1-弹出新增窗口"><a href="#1-1-1-弹出新增窗口" class="headerlink" title="1.1.1. 弹出新增窗口"></a>1.1.1. <strong>弹出新增窗口</strong></h3><p>页面中已经提供了新增窗口，只是处于隐藏状态。只需要将控制展示状态的属性dialogFormVisible改为true就可以显示出新增窗口。</p>
<p>新建按钮绑定的方法为handleCreate，所以在handleCreate方法中修改dialogFormVisible属性的值为true即可。同时为了增加用户体验度，需要每次点击新建按钮时清空表单输入项。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 重置表单</span></span><br><span class="line"><span class="function"><span class="title">resetForm</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.formData = &#123;&#125;;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 弹出添加窗口</span></span><br><span class="line"><span class="function"><span class="title">handleCreate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.resetForm();</span><br><span class="line">    <span class="built_in">this</span>.dialogFormVisible = <span class="literal">true</span>;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="1-1-2-输入校验"><a href="#1-1-2-输入校验" class="headerlink" title="1.1.2. 输入校验"></a>1.1.2. 输入校验</h3><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">rules: &#123;<span class="comment">//校验规则</span></span><br><span class="line">    code: [&#123; required: <span class="literal">true</span>, message: &#x27;项目编码为必填项&#x27;, trigger: &#x27;blur&#x27; &#125;],</span><br><span class="line">    name: [&#123; required: <span class="literal">true</span>, message: &#x27;项目名称为必填项&#x27;, trigger: &#x27;blur&#x27; &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-1-3-提交表单数据"><a href="#1-1-3-提交表单数据" class="headerlink" title="1.1.3. 提交表单数据"></a>1.1.3. <strong>提交表单数据</strong></h3><p>点击新增窗口中的确定按钮时，触发handleAdd方法，所以需要在handleAdd方法中进行完善。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//添加</span></span><br><span class="line">handleAdd () &#123;</span><br><span class="line">    <span class="comment">//校验表单输入项是否合法</span></span><br><span class="line">    <span class="built_in">this</span>.$refs[<span class="string">&#x27;dataAddForm&#x27;</span>].validate(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">            <span class="comment">//表单数据校验通过，发送ajax请求将表单数据提交到后台</span></span><br><span class="line">            axios.post(<span class="string">&quot;/checkitem/add.do&quot;</span>,<span class="built_in">this</span>.formData).then(<span class="function">(<span class="params">res</span>)=&gt;</span> &#123;</span><br><span class="line">                <span class="comment">//隐藏新增窗口</span></span><br><span class="line">                <span class="built_in">this</span>.dialogFormVisible = <span class="literal">false</span>;</span><br><span class="line">                <span class="comment">//判断后台返回的flag值，true表示添加操作成功，false为添加操作失败</span></span><br><span class="line">                <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">                    <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">                        <span class="attr">message</span>: res.data.message,</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">this</span>.$message.error(res.data.message);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.$message.error(<span class="string">&quot;表单数据校验失败&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//分页查询</span></span><br><span class="line"><span class="function"><span class="title">findPage</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="1-2-后台代码"><a href="#1-2-后台代码" class="headerlink" title="1.2. 后台代码"></a>1.2. <strong>后台代码</strong></h2><h3 id="1-2-1-Controller"><a href="#1-2-1-Controller" class="headerlink" title="1.2.1. Controller"></a>1.2.1. <strong>Controller</strong></h3><p>在health_web工程中创建CheckItemController</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Reference;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.Result;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.pojo.CheckItem;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.service.CheckItemService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 体检检查项管理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/checkitem&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckItemController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Reference</span></span><br><span class="line">    <span class="keyword">private</span> CheckItemService checkItemService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//新增</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">add</span><span class="params">(<span class="meta">@RequestBody</span> CheckItem checkItem)</span></span>&#123;</span><br><span class="line">        checkItemService.add(checkItem);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>,MessageConstant.ADD_CHECKITEM_SUCCESS);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-2-服务接口"><a href="#1-2-2-服务接口" class="headerlink" title="1.2.2. 服务接口"></a>1.2.2. <strong>服务接口</strong></h3><p>在health_interface工程中创建CheckItemService接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.itheima.health.pojo.CheckItem;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查项服务接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CheckItemService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(CheckItem checkItem)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-2-3-服务实现类"><a href="#1-2-3-服务实现类" class="headerlink" title="1.2.3. 服务实现类"></a>1.2.3. <strong>服务实现类</strong></h3><p>在health_service工程中创建CheckItemServiceImpl实现类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.dao.CheckItemDao;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.pojo.CheckItem;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查项服务</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(interfaceClass = CheckItemService.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckItemServiceImpl</span> <span class="keyword">implements</span> <span class="title">CheckItemService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CheckItemDao checkItemDao;</span><br><span class="line">    <span class="comment">//新增</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(CheckItem checkItem)</span> </span>&#123;</span><br><span class="line">        checkItemDao.add(checkItem);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-4-Dao接口"><a href="#1-2-4-Dao接口" class="headerlink" title="1.2.4. Dao接口"></a>1.2.4. <strong>Dao接口</strong></h3><p>在health_dao工程中创建CheckItemDao接口，本项目是基于Mybatis的Mapper代理技术实现持久层操作，故只需要提供接口和Mapper映射文件，无须提供实现类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.itheima.health.pojo.CheckItem;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 持久层Dao接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CheckItemDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(CheckItem checkItem)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-5-Mapper映射文件"><a href="#1-2-5-Mapper映射文件" class="headerlink" title="1.2.5. Mapper映射文件"></a>1.2.5. <strong>Mapper映射文件</strong></h3><p>在health_dao工程中创建CheckItemDao.xml映射文件，需要和CheckItemDao接口在同一目录下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.itheima.health.dao.CheckItemDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--新增--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;add&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.itheima.health.pojo.CheckItem&quot;</span>&gt;</span></span><br><span class="line">        insert into t_checkitem(code,name,sex,age,price,type,remark,attention)</span><br><span class="line">        values</span><br><span class="line">        (#&#123;code&#125;,#&#123;name&#125;,#&#123;sex&#125;,#&#123;age&#125;,#&#123;price&#125;,#&#123;type&#125;,#&#123;remark&#125;,#&#123;attention&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="【小结】"><a href="#【小结】" class="headerlink" title="【小结】"></a>【小结】</h3><ol>
<li><p>先分析，业务对象是谁，对应表结构在哪里，表中的字段是什么意思</p>
</li>
<li><p>新增，表中数据从哪里来，从前端, 提供输入formData双向绑定，提交数据formData</p>
</li>
<li><p>写出操作的步骤，按着步骤完成代码</p>
</li>
<li><p>套路：</p>
<p>前端提请求 数据类型-&gt;Controller接收数据型-&gt;调用service-&gt;调用dao-&gt;映射文件</p>
<p>dao-&gt;service-&gt;controller-&gt;页面，提示结果，如果成功怎么样，失败怎么样</p>
</li>
</ol>
<h1 id="2-检查项分页"><a href="#2-检查项分页" class="headerlink" title="2. 检查项分页"></a>2. 检查项分页</h1><h3 id="【目标】-1"><a href="#【目标】-1" class="headerlink" title="【目标】"></a>【目标】</h3><p>1：熟悉分页功能中的请求参数</p>
<p>2：熟悉分页功能中的响应数据</p>
<p>3：检查项分页功能实现</p>
<h3 id="【路径】-1"><a href="#【路径】-1" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：前台代码 checkitem.html</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">需要提交的</span><br><span class="line">&#123;</span><br><span class="line">    page: 页码</span><br><span class="line">    size: 大小</span><br><span class="line">    条件: </span><br><span class="line">&#125;</span><br><span class="line">响应的结果</span><br><span class="line">&#123;</span><br><span class="line">    flag:</span><br><span class="line">    message:</span><br><span class="line">    data:&#123;   pageResult</span><br><span class="line">    	total: <span class="number">100</span>,</span><br><span class="line">    	rows:[]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>查询绑定事件，提交查询的条件pagination(页码，大小，查询的条件)，对结果进行提示，成功，绑定列表数据dataList=res.data.data.rows，绑定总记录数pagination.total=res.data.data.total。</p>
</li>
<li><p>CheckItemController 用QueryPageBean接收pagination对象, 调用服务查询返回pageResult, 返回Result(flag,message,data: pageResult)</p>
</li>
<li><p>CheckItemService, 实现分页查询 有条件则要模糊查询，调用Dao查询。且返回pageResult</p>
<p>使用PageHelper, PageHelper.startPage(页码，大小), 紧接着的查询语句会被分页</p>
</li>
<li><p>CheckitemDao 条件查询Page<CheckItem></p>
</li>
</ol>
<p>本项目所有分页功能都是基于ajax的异步请求来完成的，请求参数和后台响应数据格式都使用json数据格式。</p>
<p>1：请求参数包括页码、每页显示记录数、查询条件。</p>
<p>请求参数的json格式为：{currentPage:1,pageSize:10,queryString:’’itcast’’}</p>
<p>2：后台响应数据包括总记录数、当前页需要展示的数据集合。</p>
<p>响应数据的json格式为：{total:1000,rows:[]}</p>
<p>如下图：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209161515.png" alt="009"></p>
<h2 id="2-1-前台代码"><a href="#2-1-前台代码" class="headerlink" title="2.1. 前台代码"></a>2.1. 前台代码</h2><h3 id="2-1-1-定义分页相关模型数据"><a href="#2-1-1-定义分页相关模型数据" class="headerlink" title="2.1.1. 定义分页相关模型数据"></a>2.1.1. 定义分页相关模型数据</h3><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">pagination: &#123;<span class="comment">//分页相关模型数据</span></span><br><span class="line">     currentPage: <span class="number">1</span>,<span class="comment">//当前页码</span></span><br><span class="line">     pageSize:<span class="number">10</span>,<span class="comment">//每页显示的记录数</span></span><br><span class="line">     total:<span class="number">0</span>,<span class="comment">//总记录数</span></span><br><span class="line">     queryString:<span class="literal">null</span><span class="comment">//查询条件</span></span><br><span class="line">&#125;,</span><br><span class="line">dataList: [],<span class="comment">//当前页要展示的分页列表数据</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-定义分页方法"><a href="#2-1-2-定义分页方法" class="headerlink" title="2.1.2. 定义分页方法"></a>2.1.2. <strong>定义分页方法</strong></h3><p>在页面中提供了findPage方法用于分页查询，为了能够在checkitem.html页面加载后直接可以展示分页数据，可以在VUE提供的钩子函数created中调用findPage方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//钩子函数，VUE对象初始化完成后自动执行</span></span><br><span class="line"><span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.findPage();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 发送查询的请求，提交pagination(currentPage,pageSize)</span></span><br><span class="line">axios.post(<span class="string">&#x27;/checkitem/findPage.do&#x27;</span>,<span class="built_in">this</span>.pagination).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">        <span class="comment">// 绑定数据</span></span><br><span class="line">        <span class="comment">//res.data =&gt; result &#123;flag, message,data&#125;</span></span><br><span class="line">       <span class="comment">// result.data = pageResult &#123;total, rows&#125;</span></span><br><span class="line">        <span class="built_in">this</span>.dataList = res.data.data.rows;</span><br><span class="line">        <span class="comment">// 总计录数</span></span><br><span class="line">        <span class="built_in">this</span>.pagination.total=res.data.data.total;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.$message.error(res.data.message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-完善分页方法执行时机"><a href="#2-1-3-完善分页方法执行时机" class="headerlink" title="2.1.3. 完善分页方法执行时机"></a>2.1.3. <strong>完善分页方法执行时机</strong></h3><p>除了在created钩子函数中调用findPage方法查询分页数据之外，当用户点击查询按钮或者点击分页条中的页码时也需要调用findPage方法重新发起查询请求。</p>
<p>为查询按钮绑定单击事件，调用findPage方法</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleCurrentChange(1)&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dalfBut&quot;</span>&gt;</span>查询<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>为分页条组件绑定current-change事件，此事件是分页条组件自己定义的事件，当页码改变时触发，对应的处理函数为handleCurrentChange</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pagination-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;pagiantion&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">current-change</span>=<span class="string">&quot;handleCurrentChange&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:current-page</span>=<span class="string">&quot;pagination.currentPage&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:page-size</span>=<span class="string">&quot;pagination.pageSize&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">layout</span>=<span class="string">&quot;total, prev, pager, next, jumper&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:total</span>=<span class="string">&quot;pagination.total&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>定义handleCurrentChange方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//切换页码</span></span><br><span class="line"><span class="function"><span class="title">handleCurrentChange</span>(<span class="params">currentPage</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// currentPage为切换后的页码</span></span><br><span class="line">    <span class="built_in">this</span>.pagination.currentPage = currentPage;</span><br><span class="line">    <span class="built_in">this</span>.findPage();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="2-2-后台代码"><a href="#2-2-后台代码" class="headerlink" title="2.2. 后台代码"></a>2.2. <strong>后台代码</strong></h2><h3 id="2-2-1-Controller"><a href="#2-2-1-Controller" class="headerlink" title="2.2.1. Controller"></a>2.2.1. <strong>Controller</strong></h3><p>在CheckItemController中增加分页查询方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/findPage&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">findPage</span><span class="params">(<span class="meta">@RequestBody</span> QueryPageBean queryPageBean)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 调用业务来分页</span></span><br><span class="line">    PageResult&lt;CheckItem&gt; pageResult = checkItemService.findPage(queryPageBean);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//return pageResult;</span></span><br><span class="line">    <span class="comment">// 返回给页面, 包装到Result, 统一风格</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.QUERY_CHECKITEM_SUCCESS,pageResult);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-2-服务接口"><a href="#2-2-2-服务接口" class="headerlink" title="2.2.2. 服务接口"></a>2.2.2. <strong>服务接口</strong></h3><p>在CheckItemService服务接口中扩展分页查询方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> queryPageBean</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">PageResult&lt;CheckItem&gt; <span class="title">findPage</span><span class="params">(QueryPageBean queryPageBean)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-3-服务实现类"><a href="#2-2-3-服务实现类" class="headerlink" title="2.2.3. 服务实现类"></a>2.2.3. <strong>服务实现类</strong></h3><p>在CheckItemServiceImpl服务实现类中实现分页查询方法，基于Mybatis分页助手插件实现分页</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> queryPageBean</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> PageResult&lt;CheckItem&gt; <span class="title">findPage</span><span class="params">(QueryPageBean queryPageBean)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//第二种，Mapper接口方式的调用，推荐这种使用方式。</span></span><br><span class="line">    PageHelper.startPage(queryPageBean.getCurrentPage(), queryPageBean.getPageSize());</span><br><span class="line">    <span class="comment">// 模糊查询 拼接 %</span></span><br><span class="line">    <span class="comment">// 判断是否有查询条件</span></span><br><span class="line">    <span class="keyword">if</span>(!StringUtils.isEmpty(queryPageBean.getQueryString()))&#123;</span><br><span class="line">        <span class="comment">// 有查询条件，拼接%</span></span><br><span class="line">        queryPageBean.setQueryString(<span class="string">&quot;%&quot;</span> + queryPageBean.getQueryString() + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 紧接着的查询语句会被分页</span></span><br><span class="line">    Page&lt;CheckItem&gt; page = checkItemDao.findByCondition(queryPageBean.getQueryString());</span><br><span class="line">    PageResult&lt;CheckItem&gt; pageResult = <span class="keyword">new</span> PageResult&lt;CheckItem&gt;(page.getTotal(), page.getResult());</span><br><span class="line">    <span class="keyword">return</span> pageResult;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>正常分页逻辑（即：不使用PageHelper）：</p>
<ul>
<li>写2条sql</li>
<li>第一条sql：select count(0) from t_checkitem where name = ‘传智身高’  –&gt;封装到PageResult中total* 第二条sql：select * from t_checkitem where name = ‘传智身高’ limit ?,?  –&gt;封装到PageResult中rows*                     </li>
<li>limit ?,?  ：第一个问号：表示从第几条开始检索  计算：(currentPage-1)*pageSize     第二个问号：表示当前页最多显示的记录数， 计算：pageSize</li>
<li>问题：1：麻烦；2：不能通用，当前切换数据库的时候改动的代码多。</li>
</ul>
<h3 id="2-2-4-Dao接口"><a href="#2-2-4-Dao接口" class="headerlink" title="2.2.4. Dao接口"></a>2.2.4. <strong>Dao接口</strong></h3><p>在CheckItemDao接口中扩展分页查询方法 </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页条件查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Page&lt;CheckItem&gt; <span class="title">findByCondition</span><span class="params">(String queryString)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-5-Mapper映射文件"><a href="#2-2-5-Mapper映射文件" class="headerlink" title="2.2.5. Mapper映射文件"></a>2.2.5. <strong>Mapper映射文件</strong></h3><p>在CheckItemDao.xml文件中增加SQL定义</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--条件查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Checkitem&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;String&quot;</span>&gt;</span></span><br><span class="line">    select * From t_checkitem</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;value !=null and value.length &gt; 0&quot;</span>&gt;</span></span><br><span class="line">        where code like #&#123;value&#125; or name like #&#123;value&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Mybatis 动态参数赋值 DynamicContext</span></span><br><span class="line"><span class="comment"> &lt;if&gt;标签里的变量，如果参数类型是基本数据类型，只能用 value 或 _parameter，这个是由它的底层ognl表达式决定的。如果参数类型是对象类型，则可以填它的属性。另外，使用#的参数可以是形参名也可以是value</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果使用if进行判断，这里需要是value读取值，不能改成其他参数。</p>
<h3 id="【小结】-1"><a href="#【小结】-1" class="headerlink" title="【小结】"></a>【小结】</h3><ol>
<li><p>提交currentPage, pageSize</p>
</li>
<li><p>使用PageHelper</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">配置它</span><br><span class="line">mybatis的拦截器</span><br><span class="line">PageHelper.startPage(页码，大小)</span><br><span class="line">dao的查询语句会被分页</span><br><span class="line"></span><br><span class="line">拦截sql语句，拼接查询总计录数的语句</span><br><span class="line">           拼接分页的语句</span><br><span class="line">ThreadLocal 线程绑定数据</span><br></pre></td></tr></table></figure></li>
<li><p>前端接收返回的结果，格式Result(PageResult)</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">result=&#123;</span><br><span class="line">    flag:<span class="literal">true</span>,</span><br><span class="line">    message:&#x27;查询成功&#x27;,</span><br><span class="line">    data:&#123;  <span class="comment">// pageResult</span></span><br><span class="line">        total: <span class="number">100</span>,</span><br><span class="line">        rows: [&#123;checkitem&#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">res.data =&gt; result</span><br><span class="line">查询的结果集  res.data.data.rows</span><br><span class="line">总计录数     res.data.data.total</span><br></pre></td></tr></table></figure></li>
<li><p>分页查询的时机：</p>
<ul>
<li>进入页面</li>
<li>页码变更时要查询</li>
<li>点击查询按钮时要查，回到第一页</li>
<li>添加成功后要查</li>
<li>修改成功后要查</li>
<li>删除成功后要查</li>
</ul>
</li>
</ol>
<h1 id="3-删除检查项"><a href="#3-删除检查项" class="headerlink" title="3. 删除检查项"></a>3. 删除检查项</h1><h3 id="【目标】-2"><a href="#【目标】-2" class="headerlink" title="【目标】"></a>【目标】</h3><p>删除检查项</p>
<h3 id="【路径】-2"><a href="#【路径】-2" class="headerlink" title="【路径】"></a>【路径】</h3><ol>
<li>绑定删除按钮，获取要删除的检查项id, 弹出询问窗口，确认后就提交请求，把id传给后台，提示返回的结果，成功则刷新列表。</li>
<li>CheckItemCotnroller接收id, 调用服务删除，返回操作结果给页面</li>
<li>CheckItemService <ul>
<li>判断检查项是否被检查组使用了 调用dao通过检查项id查询检查组与检查项的关系表，统计个数</li>
<li>个数&gt;0不能删除，报错, 抛出自定义异常</li>
<li>=0就可以删除</li>
</ul>
</li>
<li>CheckItemDao<ul>
<li>通过检查项id查询检查组与检查项的关系表，统计个数</li>
<li>通过id删除检查项</li>
</ul>
</li>
<li>做一个全局异常处理 @ControllerAdvice</li>
</ol>
<h3 id="【讲解】-1"><a href="#【讲解】-1" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="3-1-前台代码"><a href="#3-1-前台代码" class="headerlink" title="3.1. 前台代码"></a>3.1. 前台代码</h2><p>为了防止用户误操作，点击删除按钮时需要弹出确认删除的提示，用户点击取消则不做任何操作，用户点击确定按钮再提交删除请求。</p>
<h3 id="3-1-1-绑定单击事件"><a href="#3-1-1-绑定单击事件" class="headerlink" title="3.1.1. 绑定单击事件"></a>3.1.1. 绑定单击事件</h3><p>需要为删除按钮绑定单击事件，并且将当前行数据作为参数传递给处理函数</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleDelete(scope.row)&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>调用的方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="function"><span class="title">handleDelete</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    alert(row.id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-2-弹出确认操作提示"><a href="#3-1-2-弹出确认操作提示" class="headerlink" title="3.1.2. 弹出确认操作提示"></a>3.1.2. 弹出确认操作提示</h3><p>用户点击删除按钮会执行handleDelete方法，此处需要完善handleDelete方法，弹出确认提示信息。ElementUI提供了$confirm方法来实现确认提示信息弹框效果</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="function"><span class="title">handleDelete</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// alert(row.id);</span></span><br><span class="line">    <span class="built_in">this</span>.$confirm(<span class="string">&quot;确认删除当前选中记录吗？&quot;</span>,<span class="string">&quot;提示&quot;</span>,&#123;<span class="attr">type</span>:<span class="string">&#x27;warning&#x27;</span>&#125;).then(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//点击确定按钮时只需此处代码</span></span><br><span class="line">        alert(<span class="string">&#x27;用户点击的是确定按钮&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209161840.png" alt="010"></p>
<h3 id="3-1-3-发送请求"><a href="#3-1-3-发送请求" class="headerlink" title="3.1.3. 发送请求"></a>3.1.3. 发送请求</h3><p>如果用户点击确定按钮就需要发送ajax请求，并且将当前检查项的id作为参数提交到后台进行删除操作</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="function"><span class="title">handleDelete</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// row行数据，数据库中的一条记录，checkitem实体对象</span></span><br><span class="line">    <span class="comment">// 获取删除的id</span></span><br><span class="line">    <span class="keyword">var</span> id = row.id;</span><br><span class="line">    <span class="comment">//alert(JSON.stringify(row));</span></span><br><span class="line">    <span class="built_in">this</span>.$confirm(<span class="string">&#x27;此操作将【永久删除】该检查项, 是否继续?&#x27;</span>, <span class="string">&#x27;提示&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">confirmButtonText</span>: <span class="string">&#x27;确定&#x27;</span>,</span><br><span class="line">        <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">    &#125;).then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 点击确定后调用</span></span><br><span class="line">        axios.post(<span class="string">&#x27;/checkitem/deleteById.do?id=&#x27;</span> + id).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">                <span class="attr">message</span>: res.data.message,</span><br><span class="line">                <span class="attr">type</span>: res.data.flag?<span class="string">&quot;success&quot;</span>:<span class="string">&quot;error&quot;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">                <span class="comment">// 成功</span></span><br><span class="line">                <span class="comment">// 刷新列表数据</span></span><br><span class="line">                <span class="built_in">this</span>.findPage();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;).catch(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 点击取消后调用</span></span><br><span class="line">        <span class="comment">// 空着，防止报错</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-后台代码"><a href="#3-2-后台代码" class="headerlink" title="3.2. 后台代码"></a>3.2. 后台代码</h2><h3 id="3-2-0-自定义异常与处理"><a href="#3-2-0-自定义异常与处理" class="headerlink" title="3.2.0 自定义异常与处理"></a>3.2.0 自定义异常与处理</h3><p>在health_common工程中创建</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: 自定义异常</span></span><br><span class="line"><span class="comment"> * 友好提示</span></span><br><span class="line"><span class="comment"> * 终止已经不符合业务逻辑的代码</span></span><br><span class="line"><span class="comment"> * User: Eric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HealthException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HealthException</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-2-1-Controller"><a href="#3-2-1-Controller" class="headerlink" title="3.2.1. Controller"></a>3.2.1. Controller</h3><p>在CheckItemController中增加删除方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/deleteById&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">deleteById</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 调用业务服务</span></span><br><span class="line">    <span class="comment">//try &#123;</span></span><br><span class="line">        checkItemService.deleteById(id);</span><br><span class="line">    <span class="comment">//&#125; catch (Exception e) &#123;</span></span><br><span class="line">     <span class="comment">//   e.printStackTrace();</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="comment">// 响应结果</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.DELETE_CHECKITEM_SUCCESS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 添加异常处理类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.Result;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.exception.HealthException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: No Description</span></span><br><span class="line"><span class="comment"> * User: Eric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 与前端约定好的，返回的都是json数据</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HealExceptionAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自定义招出的异常处理</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> he</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(HealthException.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">handleHealthException</span><span class="params">(HealthException he)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">false</span>, he.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所有未知的异常</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> he</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">handleException</span><span class="params">(Exception he)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">false</span>, <span class="string">&quot;发生未知错误，操作失败，请联系管理员&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="3-2-2-服务接口"><a href="#3-2-2-服务接口" class="headerlink" title="3.2.2. 服务接口"></a>3.2.2. 服务接口</h3><p>在CheckItemService服务接口中扩展删除方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span> <span class="keyword">throws</span> HealthException</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-3-服务实现类"><a href="#3-2-3-服务实现类" class="headerlink" title="3.2.3. 服务实现类"></a>3.2.3. 服务实现类</h3><p>注意：不能直接删除，需要判断当前检查项是否和检查组关联，如果已经和检查组进行了关联则不允许删除</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> HealthException </span>&#123;</span><br><span class="line">    <span class="comment">//先判断这个检查项是否被检查组使用了</span></span><br><span class="line">    <span class="comment">//调用dao查询检查项的id是否在t_checkgroup_checkitem表中存在记录</span></span><br><span class="line">    <span class="keyword">int</span> cnt = checkItemDao.findCountByCheckItemId(id);</span><br><span class="line">    <span class="comment">//被使用了则不能删除</span></span><br><span class="line">    <span class="keyword">if</span>(cnt &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//??? health_web能捕获到这个异常吗？</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HealthException(MessageConstant.CHECKITEM_IN_USE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//没使用就可以调用dao删除</span></span><br><span class="line">    checkItemDao.deleteById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-4-Dao接口"><a href="#3-2-4-Dao接口" class="headerlink" title="3.2.4. Dao接口"></a>3.2.4. Dao接口</h3><p>在CheckItemDao接口中扩展方法findCountByCheckItemId和deleteById</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查 检查项是否被检查组使用了</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findCountByCheckItemId</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id删除检查项</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-5-Mapper映射文件"><a href="#3-2-5-Mapper映射文件" class="headerlink" title="3.2.5. Mapper映射文件"></a>3.2.5. Mapper映射文件</h3><p>在CheckItemDao.xml中扩展SQL语句</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">查询优化</span></span><br><span class="line"><span class="comment">select count(1) from t_checkitem; 1</span></span><br><span class="line"><span class="comment"> 使用人混淆</span></span><br><span class="line"><span class="comment">select count(100) from t_checkitem; 1</span></span><br><span class="line"><span class="comment">select count(&#x27;abc1&#x27;) from t_checkitem; 1</span></span><br><span class="line"><span class="comment">上面三条语句相对而言，查询速度最快</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">相对而言慢一丢丢，原因，要解析列名是否在表中存在</span></span><br><span class="line"><span class="comment">select count(id) from t_checkitem; 2</span></span><br><span class="line"><span class="comment">最慢，原因，要解析*含义，列表表中所有的列</span></span><br><span class="line"><span class="comment">select count(*) from t_checkitem;  3</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findCountByCheckItemId&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        select count(1) from t_checkgroup_checkitem where checkitem_id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        delete from t_checkitem where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="【小结】-2"><a href="#【小结】-2" class="headerlink" title="【小结】"></a>【小结】</h3><ol>
<li>企业开发分为2种：物理删除（删除表中的数据），逻辑删除(多)(更新表的字段status,state,active 为失效, 代表着这条记录不再使用</li>
<li>自定义异常 作用</li>
<li>全局异常处理@RestControllerAdvice, @ExceptionHandler</li>
<li>删除时要询问提示一下，防止用户操作失误</li>
<li>在dubbo的架构中，服务端抛出自定义异常要在接口的方法中声明抛出，否则会被dubbo转成RuntimeException</li>
</ol>
<h1 id="4-编辑检查项"><a href="#4-编辑检查项" class="headerlink" title="4. 编辑检查项"></a>4. <strong>编辑检查项</strong></h1><h3 id="【目标】-3"><a href="#【目标】-3" class="headerlink" title="【目标】"></a>【目标】</h3><p>1：编辑检查项（ID查询，回显）</p>
<p>2：编辑检查项（更新保存，执行update）</p>
<h3 id="【路径】-3"><a href="#【路径】-3" class="headerlink" title="【路径】"></a>【路径】</h3><ol>
<li><p>回显数据</p>
<ul>
<li>绑定编辑按钮，清空表单，弹出编辑窗口，获取id, 发送请求，获取响应的数据绑定到formData，如果失败要提示</li>
<li>CheckItemController, CheckItemService, checkItemDao, 通过id查询检查项</li>
</ul>
</li>
<li><p>修改的提交</p>
<ul>
<li>绑定确定按钮，校验后发送请求提交formData。提示返回的结果，成功则关闭编辑窗口，刷新列表数据</li>
<li>CheckItemController, checkItemService, checkItemDao 更新的方法</li>
</ul>
</li>
</ol>
<h3 id="【讲解】-2"><a href="#【讲解】-2" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="4-1-前台代码"><a href="#4-1-前台代码" class="headerlink" title="4.1. 前台代码"></a>4.1. 前台代码</h2><p>用户点击编辑按钮时，需要弹出编辑窗口并且将当前记录的数据进行回显，用户修改完成后点击确定按钮将修改后的数据提交到后台进行数据库操作。</p>
<h3 id="4-1-1-绑定单击事件"><a href="#4-1-1-绑定单击事件" class="headerlink" title="4.1.1. 绑定单击事件"></a>4.1.1. <strong>绑定单击事件</strong></h3><p>需要为编辑按钮绑定单击事件，并且将当前行数据作为参数传递给处理函数</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleUpdate(scope.row)&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>处理事件：handleUpdate();</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 弹出编辑窗口</span></span><br><span class="line"><span class="function"><span class="title">handleUpdate</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    alert(row.id);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="4-1-2-弹出编辑窗口回显数据"><a href="#4-1-2-弹出编辑窗口回显数据" class="headerlink" title="4.1.2. 弹出编辑窗口回显数据"></a>4.1.2. <strong>弹出编辑窗口回显数据</strong></h3><p>当前页面中的编辑窗口已经提供好了，默认处于隐藏状态。在handleUpdate方法中需要将编辑窗口展示出来，并且需要发送ajax请求查询当前检查项数据用于回显</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 弹出编辑窗口</span></span><br><span class="line"><span class="function"><span class="title">handleUpdate</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.resetForm();</span><br><span class="line">    <span class="keyword">var</span> id = row.id;</span><br><span class="line">    <span class="comment">// 弹出编辑窗口</span></span><br><span class="line">    <span class="built_in">this</span>.dialogFormVisible4Edit = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// 回显 发送请求</span></span><br><span class="line">    axios.get(<span class="string">&#x27;/checkitem/findById.do?id=&#x27;</span> + id).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">            <span class="comment">// 绑定数据回显, 编辑的form表单也绑定了这个formData</span></span><br><span class="line">            <span class="built_in">this</span>.formData = res.data.data;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.$message.error(res.data.message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="4-1-3-发送请求更改数据"><a href="#4-1-3-发送请求更改数据" class="headerlink" title="4.1.3. 发送请求更改数据"></a>4.1.3. 发送请求更改数据</h3><p>在编辑窗口中修改完成后，点击确定按钮需要提交请求，所以需要为确定按钮绑定事件并提供处理函数handleEdit</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&quot;footer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;dialogFormVisible4Edit = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleEdit()&quot;</span>&gt;</span>确定<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>handleEdit()方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//编辑提交</span></span><br><span class="line"><span class="function"><span class="title">handleEdit</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 提交修改</span></span><br><span class="line">    <span class="built_in">this</span>.$refs[<span class="string">&#x27;dataEditForm&#x27;</span>].validate(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">            <span class="comment">// 所有检验通过, 提交数据给后台this.formData</span></span><br><span class="line">            axios.post(<span class="string">&#x27;/checkitem/update.do&#x27;</span>, <span class="built_in">this</span>.formData).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">                <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">                    <span class="attr">message</span>: res.data.message,</span><br><span class="line">                    <span class="attr">type</span>: res.data.flag?<span class="string">&quot;success&quot;</span>:<span class="string">&quot;error&quot;</span></span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">                    <span class="comment">// 成功的处理</span></span><br><span class="line">                    <span class="comment">// 关闭窗口</span></span><br><span class="line">                    <span class="built_in">this</span>.dialogFormVisible4Edit = <span class="literal">false</span>;</span><br><span class="line">                    <span class="comment">// 刷新列表数据</span></span><br><span class="line">                    <span class="built_in">this</span>.findPage();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;error submit!!&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="4-2-后台代码"><a href="#4-2-后台代码" class="headerlink" title="4.2. 后台代码"></a>4.2. <strong>后台代码</strong></h2><h3 id="4-2-1-Controller"><a href="#4-2-1-Controller" class="headerlink" title="4.2.1. Controller"></a>4.2.1. <strong>Controller</strong></h3><p>在CheckItemController中增加编辑方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/findById&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">findById</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    CheckItem checkItem = checkItemService.findById(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.QUERY_CHECKITEM_SUCCESS,checkItem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改检查项</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkitem</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/update&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">update</span><span class="params">(<span class="meta">@RequestBody</span> CheckItem checkitem)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 调用业务服务</span></span><br><span class="line">    checkItemService.update(checkitem);</span><br><span class="line">    <span class="comment">// 响应结果给前端</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.EDIT_CHECKITEM_SUCCESS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-2-服务接口"><a href="#4-2-2-服务接口" class="headerlink" title="4.2.2. 服务接口"></a>4.2.2. <strong>服务接口</strong></h3><p>在CheckItemService服务接口中扩展编辑方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">CheckItem <span class="title">findById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 更新检查项</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkitem</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(CheckItem checkitem)</span></span>;</span><br></pre></td></tr></table></figure>



<h3 id="4-2-3-服务实现类"><a href="#4-2-3-服务实现类" class="headerlink" title="4.2.3. 服务实现类"></a>4.2.3. <strong>服务实现类</strong></h3><p>在CheckItemServiceImpl实现类中实现编辑方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CheckItem <span class="title">findById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> checkItemDao.findById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 更新</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkitem</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(CheckItem checkitem)</span> </span>&#123;</span><br><span class="line">    checkItemDao.update(checkitem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-4-Dao接口"><a href="#4-2-4-Dao接口" class="headerlink" title="4.2.4. Dao接口"></a>4.2.4. <strong>Dao接口</strong></h3><p>在CheckItemDao接口中扩展edit方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">CheckItem <span class="title">findById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 更新检查项</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkitem</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(CheckItem checkitem)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-5-Mapper映射文件"><a href="#4-2-5-Mapper映射文件" class="headerlink" title="4.2.5. Mapper映射文件"></a>4.2.5. <strong>Mapper映射文件</strong></h3><p>在CheckItemDao.xml中扩展SQL语句</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;checkitem&quot;</span>&gt;</span></span><br><span class="line">    select * From t_checkitem where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;checkitem&quot;</span>&gt;</span></span><br><span class="line">    update t_checkitem</span><br><span class="line">    set</span><br><span class="line">        code=#&#123;code&#125;,</span><br><span class="line">        name=#&#123;name&#125;,</span><br><span class="line">        sex=#&#123;sex&#125;,</span><br><span class="line">        age=#&#123;age&#125;,</span><br><span class="line">        price=#&#123;price&#125;,</span><br><span class="line">        type=#&#123;type&#125;,</span><br><span class="line">        remark=#&#123;remark&#125;,</span><br><span class="line">        attention=#&#123;attention&#125;</span><br><span class="line">    where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="【小结】-3"><a href="#【小结】-3" class="headerlink" title="【小结】"></a>【小结】</h3><ul>
<li><p>数据回显</p>
<p>通过id查询，绑定到formData</p>
</li>
<li><p>修改后提交 </p>
<p>跟添加类似, 表单校验，提交formData</p>
</li>
</ul>
<p>注意：数据类型要与实体匹配, 价格的输入框的值必须是数字</p>
<h1 id="5-新增检查组"><a href="#5-新增检查组" class="headerlink" title="5. 新增检查组"></a>5. 新增检查组</h1><p>【需求】</p>
<p>检查组其实就是多个检查项的集合，例如有一个检查组为“一般检查”，这个检查组可以包括多个检查项：身高、体重、收缩压、舒张压等。所以在添加检查组时需要选择这个检查组包括的检查项。</p>
<p>检查组对应的实体类为CheckGroup，对应的数据表为t_checkgroup。检查组和检查项为多对多关系，所以需要中间表t_checkgroup_checkitem进行关联。</p>
<h3 id="【目标】-4"><a href="#【目标】-4" class="headerlink" title="【目标】"></a>【目标】</h3><p>新增检查组</p>
<h3 id="【路径】-4"><a href="#【路径】-4" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：前台代码</p>
<ul>
<li>绑定新建按钮事件，弹出新增窗口，重置表单，请求检查项列表数据，绑定到tableData.</li>
<li>绑定确定按钮，提交formData检查组信息, 选中的检查项checkitemIds集合, 提示操作的信息，成功则关闭新增窗口，刷新列表数据</li>
</ul>
<p>2：后台代码</p>
<ul>
<li>CheckGroupController 接收formData 用CheckGroup, checkitemIds=&gt;用Integer[] 数组。调用业务添加，返回结果给页面</li>
<li>CheckGroupService<ul>
<li>调用Dao添加到检查组</li>
<li>获取新添加的检查组id</li>
<li>遍历checkitemIds, 调用dao添加检查组与检查项的关系</li>
<li>添加事务控制</li>
</ul>
</li>
<li>CheckGroupDao<ul>
<li>添加检查组  selectKey</li>
<li>添加检查组与检查项的关系</li>
</ul>
</li>
</ul>
<h3 id="【讲解】-3"><a href="#【讲解】-3" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="5-1-前台代码"><a href="#5-1-前台代码" class="headerlink" title="5.1. 前台代码"></a>5.1. <strong>前台代码</strong></h2><p>检查组管理页面对应的是checkgroup.html页面，根据产品设计的原型已经完成了页面基本结构的编写，现在需要完善页面动态效果。</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209161809.png" alt="image-20200622081424895"></p>
<h3 id="5-1-1-弹出新增窗口"><a href="#5-1-1-弹出新增窗口" class="headerlink" title="5.1.1. 弹出新增窗口"></a>5.1.1. <strong>弹出新增窗口</strong></h3><p>页面中已经提供了新增窗口，只是出于隐藏状态。只需要将控制展示状态的属性dialogFormVisible改为true即可显示出新增窗口。点击新建按钮时绑定的方法为handleCreate，所以在handleCreate方法中修改dialogFormVisible属性的值为true即可。同时为了增加用户体验度，需要每次点击新建按钮时清空表单输入项。</p>
<p>由于新增检查组时还需要选择此检查组包含的检查项，所以新增检查组窗口分为两部分信息：基本信息和检查项信息，如下图：</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209161801.png" alt="image-20200622080915611"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209161754.png" alt="image-20200622081030498"></p>
<p>（1）新建按钮绑定单击事件，对应的处理函数为handleCreate</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">class</span>=<span class="string">&quot;butT&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleCreate()&quot;</span>&gt;</span>新建<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）handleCreate()方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 重置表单</span></span><br><span class="line"><span class="function"><span class="title">resetForm</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 清空表单</span></span><br><span class="line">    <span class="built_in">this</span>.formData = &#123;&#125;;</span><br><span class="line">    <span class="built_in">this</span>.activeName=<span class="string">&#x27;first&#x27;</span>; <span class="comment">//选中基本信息标签项</span></span><br><span class="line">    <span class="comment">// 清除钩选</span></span><br><span class="line">    <span class="built_in">this</span>.checkitemIds=[];</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 弹出添加窗口</span></span><br><span class="line"><span class="function"><span class="title">handleCreate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">//重置表单，弹出窗口</span></span><br><span class="line">    <span class="built_in">this</span>.resetForm();</span><br><span class="line">    <span class="built_in">this</span>.dialogFormVisible = <span class="literal">true</span>;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="5-1-2-新增窗口中，动态展示检查项列表"><a href="#5-1-2-新增窗口中，动态展示检查项列表" class="headerlink" title="5.1.2. 新增窗口中，动态展示检查项列表"></a>5.1.2. 新增窗口中，动态展示检查项列表</h3><p>现在虽然已经完成了新增窗口的弹出，但是在检查项信息标签页中需要动态展示所有的检查项信息列表数据，并且可以进行勾选。具体操作步骤如下：</p>
<p>（1）定义模型数据</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">tableData:[],<span class="comment">//新增和编辑表单中对应的检查项列表数据</span></span><br><span class="line"><span class="attr">checkitemIds</span>:[],<span class="comment">//新增和编辑表单中检查项对应的复选框，基于双向绑定可以进行回显和数据提交，传递检查项id的数组</span></span><br></pre></td></tr></table></figure>

<p>（2）动态展示检查项列表数据，数据来源于上面定义的tableData模型数据</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-tab-pane</span> <span class="attr">label</span>=<span class="string">&quot;检查项信息&quot;</span> <span class="attr">name</span>=<span class="string">&quot;second&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;checkScrol&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;datatable&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>选择<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>项目编码<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>项目名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>项目说明<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">&quot;c in tableData&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">input</span> <span class="attr">:id</span>=<span class="string">&quot;c.id&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;checkitemIds&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">:for</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span>&#123;&#123;c.code&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">:for</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span>&#123;&#123;c.name&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">:for</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span>&#123;&#123;c.remark&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-tab-pane</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（3）完善handleCreate方法，发送ajax请求查询所有检查项数据并将结果赋值给tableData模型数据用于页面表格展示</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 弹出添加窗口</span></span><br><span class="line"><span class="function"><span class="title">handleCreate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">//重置表单，弹出窗口</span></span><br><span class="line">    <span class="built_in">this</span>.resetForm();</span><br><span class="line">    <span class="built_in">this</span>.dialogFormVisible = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//发送请求后台获取所有检查项数据，得到后绑定tableData(检查项列表)</span></span><br><span class="line">    axios.get(<span class="string">&#x27;/checkitem/findAll.do&#x27;</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">            <span class="built_in">this</span>.tableData = res.data.data;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.$message.error(res.data.message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>（4）分别在CheckItemController、CheckItemService、CheckItemServiceImpl、CheckItemDao、CheckItemDao.xml中扩展方法查询所有检查项数据</p>
<p>【1】：CheckItemController：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/findAll&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 调用服务查询所有的检查项</span></span><br><span class="line">    List&lt;CheckItem&gt; list = checkItemService.findAll();</span><br><span class="line">    <span class="comment">// 封装返回的结果</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.QUERY_CHECKITEM_SUCCESS,list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>【2】：CheckItemService：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">List&lt;CheckItem&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>【3】：CheckItemServiceImpl：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;CheckItem&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> checkItemDao.findAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>【4】：CheckItemDao：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">List&lt;CheckItem&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>【5】：CheckItemDao.xml：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;CheckItem&quot;</span>&gt;</span></span><br><span class="line">    select * from t_checkitem</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="5-1-3-提交请求，执行保存"><a href="#5-1-3-提交请求，执行保存" class="headerlink" title="5.1.3. 提交请求，执行保存"></a>5.1.3. <strong>提交请求，执行保存</strong></h3><p>当用户点击新增窗口中的确定按钮时发送ajax请求将数据提交到后台进行数据库操作。提交到后台的数据分为两部分：检查组基本信息（对应的模型数据为formData）和检查项id数组（对应的模型数据为checkitemIds）。</p>
<p>（1）为确定按钮绑定单击事件，对应的处理函数为handleAdd</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleAdd()&quot;</span>&gt;</span>确定<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）完善handleAdd方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//添加</span></span><br><span class="line">handleAdd () &#123;</span><br><span class="line">    <span class="comment">//提交检查组信息this.formData, 选中的检查项id this.checkitemIds</span></span><br><span class="line">    axios.post(<span class="string">&#x27;/checkgroup/add.do?checkitemIds=&#x27;</span> + <span class="built_in">this</span>.checkitemIds, <span class="built_in">this</span>.formData).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">            <span class="attr">message</span>: res.data.message,</span><br><span class="line">            <span class="attr">type</span>: res.data.flag?<span class="string">&quot;success&quot;</span>:<span class="string">&quot;error&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">            <span class="comment">// 关闭窗口</span></span><br><span class="line">            <span class="built_in">this</span>.dialogFormVisible = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// 刷新列表数据</span></span><br><span class="line">            <span class="built_in">this</span>.findPage();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="5-2-后台代码"><a href="#5-2-后台代码" class="headerlink" title="5.2. 后台代码"></a>5.2. <strong>后台代码</strong></h2><h3 id="2-2-1-Controller-1"><a href="#2-2-1-Controller-1" class="headerlink" title="2.2.1. Controller"></a>2.2.1. <strong>Controller</strong></h3><p>在health_web工程中创建CheckGroupController</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Reference;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.QueryPageBean;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.Result;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.pojo.CheckGroup;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.service.CheckGroupService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: No Description</span></span><br><span class="line"><span class="comment"> * User: Eric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/checkgroup&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckGroupController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Reference</span></span><br><span class="line">    <span class="keyword">private</span> CheckGroupService checkGroupService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加检查组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkGroup</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkitemIds</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">add</span><span class="params">(<span class="meta">@RequestBody</span> CheckGroup checkGroup, Integer[] checkitemIds)</span></span>&#123;</span><br><span class="line">        <span class="comment">// 调用业务服务</span></span><br><span class="line">        checkGroupService.add(checkGroup, checkitemIds);</span><br><span class="line">        <span class="comment">// 响应结果</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.ADD_CHECKGROUP_SUCCESS);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-2-服务接口"><a href="#5-2-2-服务接口" class="headerlink" title="5.2.2. 服务接口"></a>5.2.2. <strong>服务接口</strong></h3><p>在health_interface工程中创建CheckGroupService接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.QueryPageBean;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.pojo.CheckGroup;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: No Description</span></span><br><span class="line"><span class="comment"> * User: Eric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CheckGroupService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加检查组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkGroup</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkitemIds</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(CheckGroup checkGroup, Integer[] checkitemIds)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-2-3-服务实现类"><a href="#5-2-3-服务实现类" class="headerlink" title="5.2.3. 服务实现类"></a>5.2.3. <strong>服务实现类</strong></h3><p>在health_service工程中创建CheckGroupServiceImpl实现类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.dao.CheckGroupDao;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.entity.QueryPageBean;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.pojo.CheckGroup;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.service.CheckGroupService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: No Description</span></span><br><span class="line"><span class="comment"> * User: Eric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(interfaceClass = CheckGroupService.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckGroupServiceImpl</span> <span class="keyword">implements</span> <span class="title">CheckGroupService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CheckGroupDao checkGroupDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkGroup</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkitemIds</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(CheckGroup checkGroup, Integer[] checkitemIds)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 添加检查组</span></span><br><span class="line">        checkGroupDao.add(checkGroup);</span><br><span class="line">        <span class="comment">// 获取检查组的id</span></span><br><span class="line">        Integer checkGroupId = checkGroup.getId();</span><br><span class="line">        <span class="comment">// 遍历检查项id, 添加检查组与检查项的关系</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> != checkitemIds)&#123;</span><br><span class="line">            <span class="comment">// 有钩选</span></span><br><span class="line">            <span class="keyword">for</span> (Integer checkitemId : checkitemIds) &#123;</span><br><span class="line">                <span class="comment">//添加检查组与检查项的关系</span></span><br><span class="line">                checkGroupDao.addCheckGroupCheckItem(checkGroupId, checkitemId);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-Dao接口"><a href="#2-4-Dao接口" class="headerlink" title="2.4. Dao接口"></a>2.4. <strong>Dao接口</strong></h3><p>在health_dao工程中创建CheckGroupDao接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.health.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.itheima.health.pojo.CheckGroup;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: No Description</span></span><br><span class="line"><span class="comment"> * User: Eric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CheckGroupDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加检查组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkGroup</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(CheckGroup checkGroup)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加检查组与检查项的关系</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkGroupId 注意要取别名，类型相同</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkitemId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCheckGroupCheckItem</span><span class="params">(<span class="meta">@Param(&quot;checkGroupId&quot;)</span> Integer checkGroupId, <span class="meta">@Param(&quot;checkitemId&quot;)</span> Integer checkitemId)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面我们使用@Param区别两个参数类型相同的参数</p>
<h3 id="5-2-5-Mapper映射文件"><a href="#5-2-5-Mapper映射文件" class="headerlink" title="5.2.5. Mapper映射文件"></a>5.2.5. <strong>Mapper映射文件</strong></h3><p>在health_dao工程中创建CheckGroupDao.xml映射文件，需要和CheckGroupDao接口在同一目录下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.itheima.health.dao.CheckGroupDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;add&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;checkgroup&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">order</span>=<span class="string">&quot;AFTER&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">            select last_insert_id()</span><br><span class="line">        <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">        insert into t_checkgroup (code,name,helpCode,sex,remark,attention)</span><br><span class="line">        values (#&#123;code&#125;,#&#123;name&#125;,#&#123;helpCode&#125;,#&#123;sex&#125;,#&#123;remark&#125;,#&#123;attention&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addCheckGroupCheckItem&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        insert into t_checkgroup_checkitem (checkgroup_id, checkitem_id)</span><br><span class="line">        values (#&#123;checkGroupId&#125;, #&#123;checkitemId&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="【小结】-4"><a href="#【小结】-4" class="headerlink" title="【小结】"></a>【小结】</h3><p>1：前台代码</p>
<p>（1）弹出新增窗口  this.dialogFormVisable=ture</p>
<ul>
<li>使用选项卡</li>
<li>选项卡一：检查组信息  放到form保存及展示 检查组信息</li>
<li>选项卡二：检查项列表，并提供复选框  供给用户来选择</li>
</ul>
<p>（2）新增窗口中，动态展示检查项列表</p>
<ul>
<li>查询所有检查项，弹出 窗口时，加载检查项列表数据 绑定到this.tableData</li>
</ul>
<p>（3）提交请求(检查组信息this.formData, 选中的检查项id this.checkitemIds)，执行保存， 关闭窗口且刷新列表</p>
<p>2：后台代码</p>
<ol>
<li>Controller用@Requestbody(只能有一个)前端传过来form表单数据=&gt;CheckGroup</li>
<li>Integer[] 数组来接收选中的检查项id数组 （提交是字符串，后台拿到的是数组，springMVC)</li>
<li>业务服务中，对多数据操作，开启事务（注意）</li>
<li>插入数据后获取id使用 selectKey select last_insert_id()</li>
</ol>
<p>优化： 添加检查组与检查项关系使用的for循环，效率比较，使用批量的方式提交</p>
<p>知识点：关系维护</p>
<p>​    基本信息，列表来钩选(关系), 只提交选中的id。</p>
<h1 id="6-检查组查询、分页"><a href="#6-检查组查询、分页" class="headerlink" title="6. 检查组查询、分页"></a>6. 检查组查询、分页</h1><h3 id="【目标】-5"><a href="#【目标】-5" class="headerlink" title="【目标】"></a>【目标】</h3><p>检查组查询、分页</p>
<h3 id="【路径】-5"><a href="#【路径】-5" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：前台代码</p>
<p>（1）定义分页相关模型数据</p>
<p>（2）定义分页方法</p>
<p>（3）完善分页方法执行时机（点击“查询”，点击“分页”）</p>
<p>2：后台代码</p>
<p>执行</p>
<ul>
<li>检查组分页查询</li>
</ul>
<p>（1）CheckGroupController.java（Controller）</p>
<p>（2）CheckGroupService.java（服务接口）</p>
<p>（3）CheckGroupServiceImpl.java（服务实现类）</p>
<p>（4）CheckGroupDao.java（Dao接口）</p>
<p>（5）CheckGroupDao.xml（Mapper映射文件）</p>
<h3 id="【讲解】-4"><a href="#【讲解】-4" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="6-1-前台代码"><a href="#6-1-前台代码" class="headerlink" title="6.1. 前台代码"></a>6.1. 前台代码</h2><h3 id="6-1-1-定义分页相关模型数据"><a href="#6-1-1-定义分页相关模型数据" class="headerlink" title="6.1.1. 定义分页相关模型数据"></a>6.1.1. 定义分页相关模型数据</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">pagination: &#123;<span class="comment">//分页相关模型数据</span></span><br><span class="line">    <span class="attr">currentPage</span>: <span class="number">1</span>,<span class="comment">//当前页码</span></span><br><span class="line">    <span class="attr">pageSize</span>:<span class="number">10</span>,<span class="comment">//每页显示的记录数</span></span><br><span class="line">    <span class="attr">total</span>:<span class="number">0</span>,<span class="comment">//总记录数</span></span><br><span class="line">    <span class="attr">queryString</span>:<span class="literal">null</span><span class="comment">//查询条件</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">dataList</span>: [],<span class="comment">//当前页要展示的分页列表数据</span></span><br></pre></td></tr></table></figure>

<h3 id="6-1-2-定义分页方法"><a href="#6-1-2-定义分页方法" class="headerlink" title="6.1.2. 定义分页方法"></a>6.1.2. <strong>定义分页方法</strong></h3><p>在页面中提供了findPage方法用于分页查询，为了能够在checkgroup.html页面加载后直接可以展示分页数据，可以在VUE提供的钩子函数created中调用findPage方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//钩子函数，VUE对象初始化完成后自动执行</span></span><br><span class="line"><span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.findPage();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>findPage()方法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//分页查询</span></span><br><span class="line"><span class="function"><span class="title">findPage</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    axios.post(<span class="string">&#x27;/checkgroup/findPage.do&#x27;</span>,<span class="built_in">this</span>.pagination).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">           <span class="built_in">this</span>.dataList = res.data.data.rows;</span><br><span class="line">           <span class="built_in">this</span>.pagination.total = res.data.data.total;</span><br><span class="line">       &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="built_in">this</span>.$message.error(res.data.message);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<h3 id="6-1-3-完善分页方法执行时机"><a href="#6-1-3-完善分页方法执行时机" class="headerlink" title="6.1.3. 完善分页方法执行时机"></a>6.1.3. <strong>完善分页方法执行时机</strong></h3><p>除了在created钩子函数中调用findPage方法查询分页数据之外，当用户点击查询按钮或者点击分页条中的页码时也需要调用findPage方法重新发起查询请求。</p>
<p>（1）为查询按钮绑定单击事件，调用findPage方法</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleCurrentChange(1)&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dalfBut&quot;</span>&gt;</span>查询<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）为分页条组件绑定current-change事件，此事件是分页条组件自己定义的事件，当页码改变时触发，对应的处理函数为handleCurrentChange</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pagination-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;pagiantion&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">current-change</span>=<span class="string">&quot;handleCurrentChange&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:current-page</span>=<span class="string">&quot;pagination.currentPage&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:page-size</span>=<span class="string">&quot;pagination.pageSize&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">layout</span>=<span class="string">&quot;total, prev, pager, next, jumper&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:total</span>=<span class="string">&quot;pagination.total&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（3）定义handleCurrentChange方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//切换页码</span></span><br><span class="line"><span class="function"><span class="title">handleCurrentChange</span>(<span class="params">currentPage</span>)</span> &#123;</span><br><span class="line">    <span class="comment">//currentPage为切换后的页码</span></span><br><span class="line">    <span class="built_in">this</span>.pagination.currentPage = currentPage;</span><br><span class="line">    <span class="built_in">this</span>.findPage();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="6-2-后台代码"><a href="#6-2-后台代码" class="headerlink" title="6.2. 后台代码"></a>6.2. <strong>后台代码</strong></h2><h3 id="6-2-1-Controller"><a href="#6-2-1-Controller" class="headerlink" title="6.2.1. Controller"></a>6.2.1. <strong>Controller</strong></h3><p>在CheckGroupController中增加分页查询方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页条件查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/findPage&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">findPage</span><span class="params">(<span class="meta">@RequestBody</span> QueryPageBean queryPageBean)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 调用业务查询</span></span><br><span class="line">    PageResult&lt;CheckGroup&gt; pageResult = checkGroupService.findPage(queryPageBean);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.QUERY_CHECKGROUP_SUCCESS, pageResult);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-2-服务接口"><a href="#6-2-2-服务接口" class="headerlink" title="6.2.2. 服务接口"></a>6.2.2. <strong>服务接口</strong></h3><p>在CheckGroupService服务接口中扩展分页查询方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页条件查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> queryPageBean</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">PageResult&lt;CheckGroup&gt; <span class="title">findPage</span><span class="params">(QueryPageBean queryPageBean)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-3-服务实现类"><a href="#6-2-3-服务实现类" class="headerlink" title="6.2.3. 服务实现类"></a>6.2.3. <strong>服务实现类</strong></h3><p>在CheckGroupServiceImpl服务实现类中实现分页查询方法，基于Mybatis分页助手插件实现分页</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页条件查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> queryPageBean</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> PageResult&lt;CheckGroup&gt; <span class="title">findPage</span><span class="params">(QueryPageBean queryPageBean)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 使用PageHelper.startPage</span></span><br><span class="line">    PageHelper.startPage(queryPageBean.getCurrentPage(), queryPageBean.getPageSize());</span><br><span class="line">    <span class="comment">// 有查询条件的处理, 模糊查询</span></span><br><span class="line">    <span class="keyword">if</span>(!StringUtils.isEmpty(queryPageBean.getQueryString()))&#123;</span><br><span class="line">        <span class="comment">// 拼接%</span></span><br><span class="line">        queryPageBean.setQueryString(<span class="string">&quot;%&quot;</span> + queryPageBean.getQueryString()+ <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 紧接着的查询会被分页</span></span><br><span class="line">    Page&lt;CheckGroup&gt; page = checkGroupDao.findByCondition(queryPageBean.getQueryString());</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> PageResult&lt;CheckGroup&gt;(page.getTotal(), page.getResult());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6-2-4-Dao接口"><a href="#6-2-4-Dao接口" class="headerlink" title="6.2.4. Dao接口"></a>6.2.4. <strong>Dao接口</strong></h3><p>在CheckGroupDao接口中扩展分页查询方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">Page&lt;CheckGroup&gt; <span class="title">findByCondition</span><span class="params">(String queryString)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-5-Mapper映射文件"><a href="#6-2-5-Mapper映射文件" class="headerlink" title="6.2.5. Mapper映射文件"></a>6.2.5. <strong>Mapper映射文件</strong></h3><p>在CheckGroupDao.xml文件中增加SQL定义</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;checkgroup&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;String&quot;</span>&gt;</span></span><br><span class="line">    select * From t_checkgroup</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;value !=null and value.length &gt; 0&quot;</span>&gt;</span></span><br><span class="line">        where code like #&#123;value&#125; or name like #&#123;value&#125; or helpCode like #&#123;value&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="【小结】-5"><a href="#【小结】-5" class="headerlink" title="【小结】"></a>【小结】</h3><p> 1：前台代码</p>
<p>（1）定义分页相关模型数据</p>
<p>（2）定义分页方法</p>
<p>findPage()方法。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//分页查询</span></span><br><span class="line"><span class="function"><span class="title">findPage</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    axios.post(<span class="string">&#x27;/checkgroup/findPage.do&#x27;</span>,<span class="built_in">this</span>.pagination).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">           <span class="built_in">this</span>.dataList = res.data.data.rows;</span><br><span class="line">           <span class="built_in">this</span>.pagination.total = res.data.data.total;</span><br><span class="line">       &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="built_in">this</span>.$message.error(res.data.message);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<p>（3）完善分页方法执行时机（点击“查询”，点击“分页”）</p>
<p>2：后台代码</p>
<p>执行</p>
<ul>
<li>检查组分页查询</li>
</ul>
<p>（1）CheckGroupController.java（Controller）</p>
<p>（2）CheckGroupService.java（服务接口）</p>
<p>（3）CheckGroupServiceImpl.java（服务实现类）</p>
<p>（4）CheckGroupDao.java（Dao接口）</p>
<p>（5）CheckGroupDao.xml（Mapper映射文件）</p>
<h1 id="7-编辑检查组"><a href="#7-编辑检查组" class="headerlink" title="7. 编辑检查组"></a>7. <strong>编辑检查组</strong></h1><h3 id="【目标】-6"><a href="#【目标】-6" class="headerlink" title="【目标】"></a>【目标】</h3><p>编辑检查组</p>
<h3 id="【路径】-6"><a href="#【路径】-6" class="headerlink" title="【路径】"></a>【路径】</h3><ol>
<li><p>回显</p>
<ul>
<li>【编辑】按钮，弹出编辑窗口，表单初始化，获取编辑的id，发送请求获取检查组信息，返回的检查组绑formData</li>
<li>获取检查项列表，绑定到tableData, 发送请求获取选中的检查项ids 绑定到checkitemIds，钩选中</li>
<li>CheckGroupController <ul>
<li>提交findById</li>
<li>通过检查组id查询选中的检查项id集合 List<Integer></li>
</ul>
</li>
<li>CheckGroupService<ul>
<li>findById</li>
<li>通过检查组id查询选中的检查项id集合 List<Integer></li>
</ul>
</li>
<li>CheckGroupDao<ul>
<li>findById</li>
<li>通过检查组id查询选中的检查项id集合 List<Integer></li>
</ul>
</li>
</ul>
</li>
<li><p>提交修改</p>
<ul>
<li>【确定】发送请求提交formData, checkitemIds。提示操作结果，成功则要关闭编辑窗口，刷新列表数据</li>
<li>CheckGroupController CheckGroup接收formData, Integer[] 接收checkItemIds，调用服务修改，返回结果给页面</li>
<li>CheckGroupService<ul>
<li>更新检查组</li>
<li>先删除旧关系</li>
<li>再添加新关系</li>
<li>事务控制</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>
<li>CheckGroupDao与映射<ul>
<li>update</li>
<li>deleteCheckGroupCheckItem t_checkgroup_checkitem</li>
</ul>
</li>
</ul>
<h3 id="【讲解】-5"><a href="#【讲解】-5" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="7-1-前台页面"><a href="#7-1-前台页面" class="headerlink" title="7.1. 前台页面"></a>7.1. 前台页面</h2><p>用户点击编辑按钮时，需要弹出编辑窗口并且将当前记录的数据进行回显，用户修改完成后点击确定按钮将修改后的数据提交到后台进行数据库操作。此处进行数据回显的时候，除了需要检查组基本信息的回显之外，还需要回显当前检查组包含的检查项（以复选框勾选的形式回显）。</p>
<h3 id="7-1-1-绑定单击事件"><a href="#7-1-1-绑定单击事件" class="headerlink" title="7.1.1. 绑定单击事件"></a>7.1.1. <strong>绑定单击事件</strong></h3><p>（1）需要为编辑按钮绑定单击事件，并且将当前行数据作为参数传递给处理函数</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleUpdate(scope.row)&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleDelete(scope.row)&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）handleUpdate事件</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 弹出编辑窗口</span></span><br><span class="line"><span class="function"><span class="title">handleUpdate</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    alert(row.id);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<h3 id="7-1-2-弹出编辑窗口回显数据"><a href="#7-1-2-弹出编辑窗口回显数据" class="headerlink" title="7.1.2. 弹出编辑窗口回显数据"></a>7.1.2. <strong>弹出编辑窗口回显数据</strong></h3><p>当前页面的编辑窗口已经提供好了，默认处于隐藏状态。在handleUpdate方法中需要将编辑窗口展示出来，并且需要发送多个ajax请求分别查询当前检查组数据、所有检查项数据、当前检查组包含的检查项id用于基本数据回显</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 重置表单</span></span><br><span class="line"><span class="function"><span class="title">resetForm</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 清空表单</span></span><br><span class="line">    <span class="built_in">this</span>.formData = &#123;&#125;;</span><br><span class="line">    <span class="built_in">this</span>.activeName=<span class="string">&#x27;first&#x27;</span>; <span class="comment">//选中基本信息标签项</span></span><br><span class="line">    <span class="comment">// 清除钩选</span></span><br><span class="line">    <span class="built_in">this</span>.checkitemIds=[];</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 弹出编辑窗口</span></span><br><span class="line"><span class="function"><span class="title">handleUpdate</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.resetForm();</span><br><span class="line">    <span class="comment">// 弹出编辑窗口</span></span><br><span class="line">    <span class="built_in">this</span>.dialogFormVisible4Edit = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// 获取检查组的id</span></span><br><span class="line">    <span class="keyword">var</span> checkGroupId = row.id;</span><br><span class="line">    axios.get(<span class="string">&quot;/checkgroup/findById.do?checkGroupId=&quot;</span> + checkGroupId).then(<span class="function"><span class="params">res</span> =&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">            <span class="comment">// 成功绑定数据</span></span><br><span class="line">            <span class="built_in">this</span>.formData = res.data.data;</span><br><span class="line">            <span class="comment">//发送请求后台获取所有检查项数据，得到后绑定tableData(检查项列表)</span></span><br><span class="line">            axios.get(<span class="string">&#x27;/checkitem/findAll.do&#x27;</span>).then(<span class="function"><span class="params">resp</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(resp.data.flag)&#123;</span><br><span class="line">                    <span class="built_in">this</span>.tableData = resp.data.data;</span><br><span class="line">                    <span class="comment">// 获取选中的检查项id, 回显数据时，检查项列表要钩选中</span></span><br><span class="line">                    axios.get(<span class="string">&quot;/checkgroup/findCheckItemIdsByCheckGroupId.do?checkGroupId=&quot;</span> + checkGroupId).then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">                        <span class="comment">// 后台要返回data必须为List</span></span><br><span class="line">                        <span class="keyword">if</span>(response.data.flag)&#123;</span><br><span class="line">                            <span class="built_in">this</span>.checkitemIds = response.data.data;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="built_in">this</span>.$message.error(response.data.message);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">this</span>.$message.error(resp.data.message);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.$message.error(res.data.message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="7-1-3-发送请求，编辑保存检查组"><a href="#7-1-3-发送请求，编辑保存检查组" class="headerlink" title="7.1.3. 发送请求，编辑保存检查组"></a>7.1.3. <strong>发送请求，编辑保存检查组</strong></h3><p>（1）在编辑窗口中修改完成后，点击确定按钮需要提交请求，所以需要为确定按钮绑定事件并提供处理函数handleEdit</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleEdit()&quot;</span>&gt;</span>确定<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）handleEdit()方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//编辑 修改后提交</span></span><br><span class="line"><span class="function"><span class="title">handleEdit</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">//提交检查组信息this.formData, 选中的检查项id this.checkitemIds</span></span><br><span class="line">    axios.post(<span class="string">&#x27;/checkgroup/update.do?checkitemIds=&#x27;</span> + <span class="built_in">this</span>.checkitemIds, <span class="built_in">this</span>.formData).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">            <span class="attr">message</span>: res.data.message,</span><br><span class="line">            <span class="attr">type</span>: res.data.flag?<span class="string">&quot;success&quot;</span>:<span class="string">&quot;error&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">            <span class="comment">// 关闭编辑窗口</span></span><br><span class="line">            <span class="built_in">this</span>.dialogFormVisible4Edit = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// 刷新列表数据</span></span><br><span class="line">            <span class="built_in">this</span>.findPage();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<h2 id="7-2-后台代码"><a href="#7-2-后台代码" class="headerlink" title="7.2. 后台代码"></a>7.2. <strong>后台代码</strong></h2><h3 id="7-2-1-Controller"><a href="#7-2-1-Controller" class="headerlink" title="7.2.1. Controller"></a>7.2.1. <strong>Controller</strong></h3><p>在CheckGroupController中增加方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id获取检查组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/findById&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">findById</span><span class="params">(<span class="keyword">int</span> checkGroupId)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 调用业务服务</span></span><br><span class="line">    CheckGroup checkGroup = checkGroupService.findById(checkGroupId);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.QUERY_CHECKGROUP_SUCCESS,checkGroup);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过检查组id查询选中的检查项id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/findCheckItemIdsByCheckGroupId&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">findCheckItemIdsByCheckGroupId</span><span class="params">(<span class="keyword">int</span> checkGroupId)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 调用服务查询</span></span><br><span class="line">    List&lt;Integer&gt; checkItemIds = checkGroupService.findCheckItemIdsByCheckGroupId(checkGroupId);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.QUERY_CHECKITEM_SUCCESS,checkItemIds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改提交</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/update&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">update</span><span class="params">(<span class="meta">@RequestBody</span> CheckGroup checkGroup, Integer[] checkitemIds)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 调用业务服务</span></span><br><span class="line">    checkGroupService.update(checkGroup, checkitemIds);</span><br><span class="line">    <span class="comment">// 响应结果</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.EDIT_CHECKGROUP_SUCCESS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="7-2-2-服务接口"><a href="#7-2-2-服务接口" class="headerlink" title="7.2.2. 服务接口"></a>7.2.2. <strong>服务接口</strong></h3><p>在CheckGroupService服务接口中扩展方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过检查组id查询选中的检查项id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroupId</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;Integer&gt; <span class="title">findCheckItemIdsByCheckGroupId</span><span class="params">(<span class="keyword">int</span> checkGroupId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id获取检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroupId</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">CheckGroup <span class="title">findById</span><span class="params">(<span class="keyword">int</span> checkGroupId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroup</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkitemIds</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(CheckGroup checkGroup, Integer[] checkitemIds)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-3-服务实现类"><a href="#7-2-3-服务实现类" class="headerlink" title="7.2.3. 服务实现类"></a>7.2.3. <strong>服务实现类</strong></h3><p>在CheckGroupServiceImpl实现类中实现编辑方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过检查组id查询选中的检查项id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroupId</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">findCheckItemIdsByCheckGroupId</span><span class="params">(<span class="keyword">int</span> checkGroupId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> checkGroupDao.findCheckItemIdsByCheckGroupId(checkGroupId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id获取检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroupId</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CheckGroup <span class="title">findById</span><span class="params">(<span class="keyword">int</span> checkGroupId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> checkGroupDao.findById(checkGroupId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroup</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkitemIds</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(CheckGroup checkGroup, Integer[] checkitemIds)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 先更新检查组</span></span><br><span class="line">    checkGroupDao.update(checkGroup);</span><br><span class="line">    <span class="comment">// 删除旧关系</span></span><br><span class="line">    checkGroupDao.deleteCheckGroupCheckItem(checkGroup.getId());</span><br><span class="line">    <span class="comment">// 建立新关系</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> != checkitemIds)&#123;</span><br><span class="line">        <span class="keyword">for</span> (Integer checkitemId : checkitemIds) &#123;</span><br><span class="line">            checkGroupDao.addCheckGroupCheckItem(checkGroup.getId(), checkitemId);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-4-Dao接口"><a href="#7-2-4-Dao接口" class="headerlink" title="7.2.4. Dao接口"></a>7.2.4. <strong>Dao接口</strong></h3><p>在CheckGroupDao接口中扩展方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过检查组id查询选中的检查项id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroupId</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;Integer&gt; <span class="title">findCheckItemIdsByCheckGroupId</span><span class="params">(<span class="keyword">int</span> checkGroupId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过id获取检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroupId</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">CheckGroup <span class="title">findById</span><span class="params">(<span class="keyword">int</span> checkGroupId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 更新检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> checkGroup</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(CheckGroup checkGroup)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除检查组与检查项的关系</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteCheckGroupCheckItem</span><span class="params">(Integer id)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-5-Mapper映射文件"><a href="#7-2-5-Mapper映射文件" class="headerlink" title="7.2.5. Mapper映射文件"></a>7.2.5. <strong>Mapper映射文件</strong></h3><p>在CheckGroupDao.xml中扩展SQL语句</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findCheckItemIdsByCheckGroupId&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    select checkitem_id from t_checkgroup_checkitem where checkgroup_id=#&#123;checkGroupId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;checkgroup&quot;</span>&gt;</span></span><br><span class="line">    select * From t_checkgroup where id=#&#123;checkGroupId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;checkgroup&quot;</span>&gt;</span></span><br><span class="line">    update t_checkgroup</span><br><span class="line">    set</span><br><span class="line">        code=#&#123;code&#125;,</span><br><span class="line">        name=#&#123;name&#125;,</span><br><span class="line">        helpCode=#&#123;helpCode&#125;,</span><br><span class="line">        sex=#&#123;sex&#125;,</span><br><span class="line">        remark=#&#123;remark&#125;,</span><br><span class="line">        attention=#&#123;attention&#125;</span><br><span class="line">    where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteCheckGroupCheckItem&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    delete from t_checkgroup_checkitem where checkgroup_id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="【小结】-6"><a href="#【小结】-6" class="headerlink" title="【小结】"></a>【小结】</h3><ol>
<li><p>回显数据，除了要回显检查组信息外，还要去查检查项列表，查询选中的检查项id集合</p>
<p>默认钩选, 把id的集合绑定this.checkitemIds</p>
</li>
<li><p>关系维护前端</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;datatable&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>选择<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>项目编码<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>项目名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>项目说明<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">&quot;c in tableData&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">:id</span>=<span class="string">&quot;c.id&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;checkitemIds&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">:for</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span>&#123;&#123;c.code&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">:for</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span>&#123;&#123;c.name&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">:for</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span>&#123;&#123;c.remark&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>提交，对已经关系维护（多对多），先删除再添加新关系</p>
</li>
<li><p>业务层如果多种修改数据库的操作，记得要加事务管理@Transactional打在方法上</p>
</li>
</ol>
<h1 id="8-删除检查组"><a href="#8-删除检查组" class="headerlink" title="8. 删除检查组"></a>8. <strong>删除检查组</strong></h1><h3 id="【目标】-7"><a href="#【目标】-7" class="headerlink" title="【目标】"></a>【目标】</h3><p>删除检查组</p>
<h3 id="【路径】-7"><a href="#【路径】-7" class="headerlink" title="【路径】"></a>【路径】</h3><p>1：前台代码</p>
<ul>
<li>【删除】编辑单击事件，弹出询问窗口，确定后提交检查组id，提示操作结果，如果成功则刷新列表数据</li>
</ul>
<p>2：后台代码</p>
<ul>
<li><p>CheckGroupController接收id,调用服务删除，返回结果给页面</p>
</li>
<li><p>CheckGroupService 事务</p>
<ul>
<li>判断检查组是否被套餐使用了</li>
<li>被使用, 报错</li>
<li>没被使用<ul>
<li>先解散，删除检查组与检查项的关系</li>
<li>再来删除检查组</li>
</ul>
</li>
</ul>
</li>
<li><p>CheckGroupDao </p>
<ul>
<li>通过检查组id查询套餐与检查组的关系的个数</li>
<li>通过检查组id删除检查组与检查项的关系</li>
<li>删除检查组</li>
</ul>
</li>
</ul>
<h3 id="【讲解】-6"><a href="#【讲解】-6" class="headerlink" title="【讲解】"></a>【讲解】</h3><h2 id="3-1-前台代码-1"><a href="#3-1-前台代码-1" class="headerlink" title="3.1. 前台代码"></a>3.1. 前台代码</h2><p>为了防止用户误操作，点击删除按钮时需要弹出确认删除的提示，用户点击取消则不做任何操作，用户点击确定按钮再提交删除请求。</p>
<h3 id="3-1-1-绑定单击事件-1"><a href="#3-1-1-绑定单击事件-1" class="headerlink" title="3.1.1. 绑定单击事件"></a>3.1.1. <strong>绑定单击事件</strong></h3><p>需要为删除按钮绑定单击事件，并且将当前行数据作为参数传递给处理函数</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleDelete(scope.row)&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>调用的方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="function"><span class="title">handleDelete</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    alert(row.id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-2-弹出确认操作-发送删除请求"><a href="#3-1-2-弹出确认操作-发送删除请求" class="headerlink" title="3.1.2. 弹出确认操作 发送删除请求"></a>3.1.2. 弹出确认操作 发送删除请求</h3><p>用户点击删除按钮会执行handleDelete方法，此处需要完善handleDelete方法，弹出确认提示信息。ElementUI提供了$confirm方法来实现确认提示信息弹框效果，如果用户点击确定按钮就需要发送ajax请求，并且将当前检查组的id作为参数提交到后台进行删除操作</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="function"><span class="title">handleDelete</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 获取删除的id</span></span><br><span class="line">    <span class="keyword">var</span> id = row.id;</span><br><span class="line">    <span class="comment">//alert(JSON.stringify(row));</span></span><br><span class="line">    <span class="built_in">this</span>.$confirm(<span class="string">&#x27;此操作将【永久删除】该检查组, 是否继续?&#x27;</span>, <span class="string">&#x27;提示&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">confirmButtonText</span>: <span class="string">&#x27;确定&#x27;</span>,</span><br><span class="line">        <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">    &#125;).then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 点击确定后调用</span></span><br><span class="line">        axios.post(<span class="string">&#x27;/checkgroup/deleteById.do?id=&#x27;</span> + id).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">                <span class="attr">message</span>: res.data.message,</span><br><span class="line">                <span class="attr">type</span>: res.data.flag?<span class="string">&quot;success&quot;</span>:<span class="string">&quot;error&quot;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">if</span>(res.data.flag)&#123;</span><br><span class="line">                <span class="comment">// 成功</span></span><br><span class="line">                <span class="comment">// 刷新列表数据</span></span><br><span class="line">                <span class="built_in">this</span>.findPage();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;).catch(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 点击取消后调用</span></span><br><span class="line">        <span class="comment">// 空着，防止报错</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-后台代码-1"><a href="#3-2-后台代码-1" class="headerlink" title="3.2. 后台代码"></a>3.2. <strong>后台代码</strong></h2><h3 id="3-2-1-Controller-1"><a href="#3-2-1-Controller-1" class="headerlink" title="3.2.1. Controller"></a>3.2.1. <strong>Controller</strong></h3><p>在CheckGroupController中增加删除方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/deleteById&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">deleteById</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="comment">//调用业务服务删除</span></span><br><span class="line">    checkGroupService.deleteById(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Result(<span class="keyword">true</span>, MessageConstant.DELETE_CHECKGROUP_SUCCESS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-2-服务接口-1"><a href="#3-2-2-服务接口-1" class="headerlink" title="3.2.2. 服务接口"></a>3.2.2. <strong>服务接口</strong></h3><p>在CheckGroupService服务接口中扩展删除方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> HealthException</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-3-服务实现类-1"><a href="#3-2-3-服务实现类-1" class="headerlink" title="3.2.3. 服务实现类"></a>3.2.3. <strong>服务实现类</strong></h3><p>注意：不能直接删除，需要判断当前检查组是否和检查项、套餐关联，如果已经和检查项、套餐进行了关联则不允许删除</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 检查 这个检查组是否被套餐使用了</span></span><br><span class="line">    <span class="keyword">int</span> count = checkGroupDao.findSetmealCountByCheckGroupId(id);</span><br><span class="line">    <span class="keyword">if</span>(count &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">// 被使用了</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HealthException(MessageConstant.CHECKGROUP_IN_USE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 没有被套餐使用,就可以删除数据</span></span><br><span class="line">    <span class="comment">// 先删除检查组与检查项的关系</span></span><br><span class="line">    checkGroupDao.deleteCheckGroupCheckItem(id);</span><br><span class="line">    <span class="comment">// 删除检查组</span></span><br><span class="line">    checkGroupDao.deleteById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-4-Dao接口-1"><a href="#3-2-4-Dao接口-1" class="headerlink" title="3.2.4. Dao接口"></a>3.2.4. <strong>Dao接口</strong></h3><p>在CheckGroupDao接口中扩展方法findSetmealAndCheckGroupCountByCheckGroupId和deleteById</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过检查组id查询是否被套餐使用了</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findSetmealCountByCheckGroupId</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除检查组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-5-Mapper映射文件-1"><a href="#3-2-5-Mapper映射文件-1" class="headerlink" title="3.2.5. Mapper映射文件"></a>3.2.5. <strong>Mapper映射文件</strong></h3><p>在CheckGroupDao.xml中扩展SQL语句</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findSetmealCountByCheckGroupId&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    select count(1) from t_setmeal_checkgroup where checkgroup_id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    delete from t_checkgroup where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="【小结】-7"><a href="#【小结】-7" class="headerlink" title="【小结】"></a>【小结】</h3><ol>
<li>删除前要判断是否被套餐使用了，业务关系使然，业务： 1个套餐下多个检查组，1个检查组下多个检查项</li>
<li>删除主表数据(t_checkgroup)，就先删除从表(t_checkgroup_checkitem)数据</li>
<li>注意事务，抛出的异常一定要在接口中声明，异常类名称不要写成HandlerException</li>
</ol>
<h2 id="事务问题"><a href="#事务问题" class="headerlink" title="事务问题"></a>事务问题</h2><p>AnnotationBean.postProcessAfterInitialization 在dubbo包下的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">开启事务控制的注解支持</span><br><span class="line">注意：此处必须加入proxy-target-class=&quot;true&quot;，</span><br><span class="line">      需要进行事务控制，会由Spring框架产生代理对象，</span><br><span class="line">      Dubbo需要将Service发布为服务，要求必须使用cglib创建代理对象。</span><br><span class="line">如果没 proxy-target-class=&quot;true&quot;, 业务实现类/方法加上@Transaction，类创建的方式为jdk动态代理,发布服务时，类名与接口包名不一致，所以不发布服务</span><br><span class="line">加上proxy-target-class=&quot;true&quot;， 业务实现类/方法加上@Transaction， 类的创建方式为SpringProxy(CGLIB)， 找@Service，看有接口申明(interfaceClass=)</span><br><span class="line">          如果有接口声明，则发布的服务接口为声明的接口，</span><br><span class="line">          如果没有的情况下则发布的服务接口为org.springframework.aop.SpringProxy</span><br><span class="line">              那么服务的消费者(controller 找的是业务服务接口）没有提供者</span><br><span class="line"></span><br><span class="line">解决事务导致找不到服务的问题</span><br><span class="line">proxy-target-class=&quot;true&quot;  同时service实现类上加上@Service(interfaceClass=接口类字节码)</span><br></pre></td></tr></table></figure>

<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209161659.png" alt="1587788820602"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211209161645.png" alt="1587788834530"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">小肥龙吃大冰淇淋</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://lvxueyangtiger.github.io/post/ff7d07a2.html">https://lvxueyangtiger.github.io/post/ff7d07a2.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lvxueyangtiger.github.io" target="_blank">小肥龙吃大冰淇淋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/javase%E5%9F%BA%E7%A1%80/">javase基础</a><a class="post-meta__tags" href="/tags/%E4%BC%A0%E6%99%BA%E5%81%A5%E5%BA%B7/">传智健康</a></div><div class="post_share"><div class="social-share" data-image="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082319.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/7b0ffafd.html"><img class="prev-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212055.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">畅购day09</div></div></a></div><div class="next-post pull-right"><a href="/post/86857cf.html"><img class="next-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082055.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">传智健康day10</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/86857cf.html" title="传智健康day10"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082055.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day10</div></div></a></div><div><a href="/post/887a3734.html" title="传智健康day03"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082121.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day03</div></div></a></div><div><a href="/post/161ea297.html" title="传智健康day04"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212120.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day04</div></div></a></div><div><a href="/post/66745618.html" title="传智健康day01"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082137.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day01</div></div></a></div><div><a href="/post/68afde2a.html" title="传智健康day09"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212025.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day09</div></div></a></div><div><a href="/post/1fa8eebc.html" title="传智健康day08"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212044.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-08</div><div class="title">传智健康day08</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC2%E7%AB%A0-%E9%A2%84%E7%BA%A6%E7%AE%A1%E7%90%86-%E6%A3%80%E6%9F%A5%E9%A1%B9%E3%80%81%E6%A3%80%E6%9F%A5%E7%BB%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">第2章 预约管理-检查项、检查组管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E6%96%B0%E5%A2%9E%E6%A3%80%E6%9F%A5%E9%A1%B9"><span class="toc-number">2.</span> <span class="toc-text">1. 新增检查项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91"><span class="toc-number">2.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91"><span class="toc-number">2.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91"><span class="toc-number">2.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text">1.1. 前台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-%E5%BC%B9%E5%87%BA%E6%96%B0%E5%A2%9E%E7%AA%97%E5%8F%A3"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.1.1. 弹出新增窗口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-%E8%BE%93%E5%85%A5%E6%A0%A1%E9%AA%8C"><span class="toc-number">2.1.2.</span> <span class="toc-text">1.1.2. 输入校验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-3-%E6%8F%90%E4%BA%A4%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.3.</span> <span class="toc-text">1.1.3. 提交表单数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">2.2.</span> <span class="toc-text">1.2. 后台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-Controller"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.2.1. Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.2.2.</span> <span class="toc-text">1.2.2. 服务接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-3-%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">2.2.3.</span> <span class="toc-text">1.2.3. 服务实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-4-Dao%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.2.4.</span> <span class="toc-text">1.2.4. Dao接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-5-Mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.5.</span> <span class="toc-text">1.2.5. Mapper映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91"><span class="toc-number">2.2.6.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E6%A3%80%E6%9F%A5%E9%A1%B9%E5%88%86%E9%A1%B5"><span class="toc-number">3.</span> <span class="toc-text">2. 检查项分页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-1"><span class="toc-number">3.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-1"><span class="toc-number">3.0.2.</span> <span class="toc-text">【路径】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">3.1.</span> <span class="toc-text">2.1. 前台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E5%AE%9A%E4%B9%89%E5%88%86%E9%A1%B5%E7%9B%B8%E5%85%B3%E6%A8%A1%E5%9E%8B%E6%95%B0%E6%8D%AE"><span class="toc-number">3.1.1.</span> <span class="toc-text">2.1.1. 定义分页相关模型数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E5%AE%9A%E4%B9%89%E5%88%86%E9%A1%B5%E6%96%B9%E6%B3%95"><span class="toc-number">3.1.2.</span> <span class="toc-text">2.1.2. 定义分页方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-3-%E5%AE%8C%E5%96%84%E5%88%86%E9%A1%B5%E6%96%B9%E6%B3%95%E6%89%A7%E8%A1%8C%E6%97%B6%E6%9C%BA"><span class="toc-number">3.1.3.</span> <span class="toc-text">2.1.3. 完善分页方法执行时机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">3.2.</span> <span class="toc-text">2.2. 后台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-Controller"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.2.1. Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2.2. 服务接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-3-%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">3.2.3.</span> <span class="toc-text">2.2.3. 服务实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-4-Dao%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.2.4.</span> <span class="toc-text">2.2.4. Dao接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-5-Mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">3.2.5.</span> <span class="toc-text">2.2.5. Mapper映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-1"><span class="toc-number">3.2.6.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%88%A0%E9%99%A4%E6%A3%80%E6%9F%A5%E9%A1%B9"><span class="toc-number">4.</span> <span class="toc-text">3. 删除检查项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-2"><span class="toc-number">4.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-2"><span class="toc-number">4.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-1"><span class="toc-number">4.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">4.1.</span> <span class="toc-text">3.1. 前台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-%E7%BB%91%E5%AE%9A%E5%8D%95%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="toc-number">4.1.1.</span> <span class="toc-text">3.1.1. 绑定单击事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-%E5%BC%B9%E5%87%BA%E7%A1%AE%E8%AE%A4%E6%93%8D%E4%BD%9C%E6%8F%90%E7%A4%BA"><span class="toc-number">4.1.2.</span> <span class="toc-text">3.1.2. 弹出确认操作提示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-3-%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82"><span class="toc-number">4.1.3.</span> <span class="toc-text">3.1.3. 发送请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">4.2.</span> <span class="toc-text">3.2. 后台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-0-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E4%B8%8E%E5%A4%84%E7%90%86"><span class="toc-number">4.2.1.</span> <span class="toc-text">3.2.0 自定义异常与处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-Controller"><span class="toc-number">4.2.2.</span> <span class="toc-text">3.2.1. Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">4.2.3.</span> <span class="toc-text">3.2.2. 服务接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">4.2.4.</span> <span class="toc-text">3.2.3. 服务实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-4-Dao%E6%8E%A5%E5%8F%A3"><span class="toc-number">4.2.5.</span> <span class="toc-text">3.2.4. Dao接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-5-Mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">4.2.6.</span> <span class="toc-text">3.2.5. Mapper映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-2"><span class="toc-number">4.2.7.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E7%BC%96%E8%BE%91%E6%A3%80%E6%9F%A5%E9%A1%B9"><span class="toc-number">5.</span> <span class="toc-text">4. 编辑检查项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-3"><span class="toc-number">5.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-3"><span class="toc-number">5.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-2"><span class="toc-number">5.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">5.1.</span> <span class="toc-text">4.1. 前台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-%E7%BB%91%E5%AE%9A%E5%8D%95%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="toc-number">5.1.1.</span> <span class="toc-text">4.1.1. 绑定单击事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-%E5%BC%B9%E5%87%BA%E7%BC%96%E8%BE%91%E7%AA%97%E5%8F%A3%E5%9B%9E%E6%98%BE%E6%95%B0%E6%8D%AE"><span class="toc-number">5.1.2.</span> <span class="toc-text">4.1.2. 弹出编辑窗口回显数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-3-%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%E6%9B%B4%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="toc-number">5.1.3.</span> <span class="toc-text">4.1.3. 发送请求更改数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">5.2.</span> <span class="toc-text">4.2. 后台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-Controller"><span class="toc-number">5.2.1.</span> <span class="toc-text">4.2.1. Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-2-%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.2.2.</span> <span class="toc-text">4.2.2. 服务接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-3-%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">5.2.3.</span> <span class="toc-text">4.2.3. 服务实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-4-Dao%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.2.4.</span> <span class="toc-text">4.2.4. Dao接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-5-Mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">5.2.5.</span> <span class="toc-text">4.2.5. Mapper映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-3"><span class="toc-number">5.2.6.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E6%96%B0%E5%A2%9E%E6%A3%80%E6%9F%A5%E7%BB%84"><span class="toc-number">6.</span> <span class="toc-text">5. 新增检查组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-4"><span class="toc-number">6.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-4"><span class="toc-number">6.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-3"><span class="toc-number">6.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">6.1.</span> <span class="toc-text">5.1. 前台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-1-%E5%BC%B9%E5%87%BA%E6%96%B0%E5%A2%9E%E7%AA%97%E5%8F%A3"><span class="toc-number">6.1.1.</span> <span class="toc-text">5.1.1. 弹出新增窗口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-2-%E6%96%B0%E5%A2%9E%E7%AA%97%E5%8F%A3%E4%B8%AD%EF%BC%8C%E5%8A%A8%E6%80%81%E5%B1%95%E7%A4%BA%E6%A3%80%E6%9F%A5%E9%A1%B9%E5%88%97%E8%A1%A8"><span class="toc-number">6.1.2.</span> <span class="toc-text">5.1.2. 新增窗口中，动态展示检查项列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-3-%E6%8F%90%E4%BA%A4%E8%AF%B7%E6%B1%82%EF%BC%8C%E6%89%A7%E8%A1%8C%E4%BF%9D%E5%AD%98"><span class="toc-number">6.1.3.</span> <span class="toc-text">5.1.3. 提交请求，执行保存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">6.2.</span> <span class="toc-text">5.2. 后台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-Controller-1"><span class="toc-number">6.2.1.</span> <span class="toc-text">2.2.1. Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-2-%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">6.2.2.</span> <span class="toc-text">5.2.2. 服务接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-3-%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">6.2.3.</span> <span class="toc-text">5.2.3. 服务实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Dao%E6%8E%A5%E5%8F%A3"><span class="toc-number">6.2.4.</span> <span class="toc-text">2.4. Dao接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-5-Mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">6.2.5.</span> <span class="toc-text">5.2.5. Mapper映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-4"><span class="toc-number">6.2.6.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E6%A3%80%E6%9F%A5%E7%BB%84%E6%9F%A5%E8%AF%A2%E3%80%81%E5%88%86%E9%A1%B5"><span class="toc-number">7.</span> <span class="toc-text">6. 检查组查询、分页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-5"><span class="toc-number">7.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-5"><span class="toc-number">7.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-4"><span class="toc-number">7.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">7.1.</span> <span class="toc-text">6.1. 前台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-1-%E5%AE%9A%E4%B9%89%E5%88%86%E9%A1%B5%E7%9B%B8%E5%85%B3%E6%A8%A1%E5%9E%8B%E6%95%B0%E6%8D%AE"><span class="toc-number">7.1.1.</span> <span class="toc-text">6.1.1. 定义分页相关模型数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-2-%E5%AE%9A%E4%B9%89%E5%88%86%E9%A1%B5%E6%96%B9%E6%B3%95"><span class="toc-number">7.1.2.</span> <span class="toc-text">6.1.2. 定义分页方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-3-%E5%AE%8C%E5%96%84%E5%88%86%E9%A1%B5%E6%96%B9%E6%B3%95%E6%89%A7%E8%A1%8C%E6%97%B6%E6%9C%BA"><span class="toc-number">7.1.3.</span> <span class="toc-text">6.1.3. 完善分页方法执行时机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">7.2.</span> <span class="toc-text">6.2. 后台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-1-Controller"><span class="toc-number">7.2.1.</span> <span class="toc-text">6.2.1. Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-2-%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.2.2.</span> <span class="toc-text">6.2.2. 服务接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-3-%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">7.2.3.</span> <span class="toc-text">6.2.3. 服务实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-4-Dao%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.2.4.</span> <span class="toc-text">6.2.4. Dao接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-5-Mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">7.2.5.</span> <span class="toc-text">6.2.5. Mapper映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-5"><span class="toc-number">7.2.6.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E7%BC%96%E8%BE%91%E6%A3%80%E6%9F%A5%E7%BB%84"><span class="toc-number">8.</span> <span class="toc-text">7. 编辑检查组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-6"><span class="toc-number">8.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-6"><span class="toc-number">8.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-5"><span class="toc-number">8.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E5%89%8D%E5%8F%B0%E9%A1%B5%E9%9D%A2"><span class="toc-number">8.1.</span> <span class="toc-text">7.1. 前台页面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-1-%E7%BB%91%E5%AE%9A%E5%8D%95%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="toc-number">8.1.1.</span> <span class="toc-text">7.1.1. 绑定单击事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-2-%E5%BC%B9%E5%87%BA%E7%BC%96%E8%BE%91%E7%AA%97%E5%8F%A3%E5%9B%9E%E6%98%BE%E6%95%B0%E6%8D%AE"><span class="toc-number">8.1.2.</span> <span class="toc-text">7.1.2. 弹出编辑窗口回显数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-3-%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%EF%BC%8C%E7%BC%96%E8%BE%91%E4%BF%9D%E5%AD%98%E6%A3%80%E6%9F%A5%E7%BB%84"><span class="toc-number">8.1.3.</span> <span class="toc-text">7.1.3. 发送请求，编辑保存检查组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-number">8.2.</span> <span class="toc-text">7.2. 后台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-1-Controller"><span class="toc-number">8.2.1.</span> <span class="toc-text">7.2.1. Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-2-%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">8.2.2.</span> <span class="toc-text">7.2.2. 服务接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-3-%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">8.2.3.</span> <span class="toc-text">7.2.3. 服务实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-4-Dao%E6%8E%A5%E5%8F%A3"><span class="toc-number">8.2.4.</span> <span class="toc-text">7.2.4. Dao接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-5-Mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">8.2.5.</span> <span class="toc-text">7.2.5. Mapper映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-6"><span class="toc-number">8.2.6.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E5%88%A0%E9%99%A4%E6%A3%80%E6%9F%A5%E7%BB%84"><span class="toc-number">9.</span> <span class="toc-text">8. 删除检查组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E7%9B%AE%E6%A0%87%E3%80%91-7"><span class="toc-number">9.0.1.</span> <span class="toc-text">【目标】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%B7%AF%E5%BE%84%E3%80%91-7"><span class="toc-number">9.0.2.</span> <span class="toc-text">【路径】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E8%AE%B2%E8%A7%A3%E3%80%91-6"><span class="toc-number">9.0.3.</span> <span class="toc-text">【讲解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81-1"><span class="toc-number">9.1.</span> <span class="toc-text">3.1. 前台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-%E7%BB%91%E5%AE%9A%E5%8D%95%E5%87%BB%E4%BA%8B%E4%BB%B6-1"><span class="toc-number">9.1.1.</span> <span class="toc-text">3.1.1. 绑定单击事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-%E5%BC%B9%E5%87%BA%E7%A1%AE%E8%AE%A4%E6%93%8D%E4%BD%9C-%E5%8F%91%E9%80%81%E5%88%A0%E9%99%A4%E8%AF%B7%E6%B1%82"><span class="toc-number">9.1.2.</span> <span class="toc-text">3.1.2. 弹出确认操作 发送删除请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81-1"><span class="toc-number">9.2.</span> <span class="toc-text">3.2. 后台代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-Controller-1"><span class="toc-number">9.2.1.</span> <span class="toc-text">3.2.1. Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3-1"><span class="toc-number">9.2.2.</span> <span class="toc-text">3.2.2. 服务接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB-1"><span class="toc-number">9.2.3.</span> <span class="toc-text">3.2.3. 服务实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-4-Dao%E6%8E%A5%E5%8F%A3-1"><span class="toc-number">9.2.4.</span> <span class="toc-text">3.2.4. Dao接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-5-Mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6-1"><span class="toc-number">9.2.5.</span> <span class="toc-text">3.2.5. Mapper映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-7"><span class="toc-number">9.2.6.</span> <span class="toc-text">【小结】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="toc-number">9.3.</span> <span class="toc-text">事务问题</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 小肥龙吃大冰淇淋</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="framework-info"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/202301132049386.png"/><span> </span><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">晋ICP备2022012091号-1</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'pinglun-9gh2lmcnd8587831',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'pinglun-9gh2lmcnd8587831',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script><script src="//code.tidio.co/smwivpnwumemac2wohardi3d3gpud1ag.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>